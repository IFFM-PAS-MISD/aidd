\documentclass[11pt,a2paper]{report}
\usepackage[dvipsnames]{xcolor}
%\usepackage{dirtytalk}
\usepackage{graphicx}
\usepackage{multirow}
\usepackage{amsmath,amssymb,bm}
%\usepackage[dvips,colorlinks=true,citecolor=green]{hyperref}
\usepackage[colorlinks=true,citecolor=green]{hyperref}
%% my added packages
\usepackage{float}
\usepackage{csquotes}
\usepackage{verbatim}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{booktabs} % for nice tables
\usepackage{csvsimple} % for csv read
\usepackage{graphicx}
%\usepackage[outdir=//odroid-sensors/sensors/aidd/reports/journal_papers/MSSP_Paper/Figures/]{epstopdf}
%\usepackage{breqn}
\usepackage{multirow}

\begin{document}
	
	\noindent We appreciate the time and effort that the reviewers have dedicated to provide valuable feedback on our manuscript. 
	We would like to thank the reviewers for constructive comments which helped us to improve the manuscript. 
	We have incorporated changes to reflect the suggestions provided by the reviewers. 
	We have highlighted the changes in a separate differential PDF document. The additional text is in the blue print. 
	The removed text is in red. \\ \\
	Here is a point-by-point response to the reviewersâ€™ comments and concerns.
	\\ \\
	\textbf{Reviewer: 1}: \\
	I thank the authors for taking into account my previous comments. 
	Overall, I find the paper very interesting even if still we don't understand really well what is actually learned by the machine learning algorithms. 
	I accept the paper but the authors should take into account the following comment and I rely on the Editor to ensure that it is the case:
	
	\textcolor{Cyan}{
		\textbf{Response:}
	Thank you for your positive feedback.
    }
	\begin{enumerate}
		\item Sec 2.2 is still impossible to understand in my opinion. 
		For example on top figure 2, if you focus on the bottom left, you can see ht-1 and xt are crossing but we don't know which signal is going upward or rightward after that crossing.
		
		\textcolor{Cyan}{
			\textbf{Response:}
		Thank you for pointing that out. We improved the figure accordingly.
		}
		
		\item There are no arrow indicating the input signals for sigma and some tanh boxes.
		
		\textcolor{Cyan}{
			\textbf{Response:}
			Thank you for the suggestion. We have added arrows to the figure.
		}
		\item Capital letter are present in the text but not in the figure. 
		In Eq 1 we see Wf but the text mentions W. 
		In Eq 3 a multiplication is referred in the text and a convolution in the equation.
		
		\textcolor{Cyan}{
			\textbf{Response:}
			Thank you for pointing that out. We have changed notations within the text so that it is consistent with the figure.
		}		
	\end{enumerate}	
	
	\newpage 
	\textbf{Reviewer: 2}\\
	The authors have addressed previous comments and suggestions adequately. 
	In this reviewer's opinion, the quality of the current manuscript meets the standards of MMSP and may be of interest to many of the journal's readers. However, I still have a little suggestion.
	 
	In this paper, the synthetic dataset used to train the proposed neural network is from the Ref.[45], and the ConvLSTM and the ADE models are the conventional networks. 
	It seems that the authors just applied the existing techniques on the existing data to solve the similar question of delamination location. 
	Some contents are very similar the previous work, such as:
	\begin{enumerate}
		\item Pawel Kudela and Abdalraheem Ijjeh. Synthetic dataset of a full wavefileld representing the propagation of Lamb waves and their interactions with delaminations, 2021. 
		\item Abdalraheem A. Ijjeh, Saeed Ullah, and Pawel Kudela. Full wavefield processing by using FCN for delamination detection. Mechanical Systems and Signal Processing, 153:107537, may 2021.
	\end{enumerate}

	I would suggest that the authors strengthen the differences between the contribution of this paper and their previous work.
	\\ \\ 
	\textcolor{Cyan}{
		\textbf{Response:}
	We are sorry to hear that the contribution of this paper is not enough highlighted in comparison to our previous work. It should be noted that the dataset used in our previous paper is completely different from the one used in the current paper. In the previous paper, the dataset consists of RMS images computed from full wavefields. It means that there is only one image per delamination scenario. In the current paper, several images per delamination scenario in the form of propagating wavefields are used. Therefore, inputs for neural networks are in the form of a single image (previous paper) and several images (current paper). It should be noted, however, that both datasets were created at the same time by using the time domain spectral element method with the same random delamination arrangements (It is explained in the \emph{Dataset} section).
	Moreover, since inputs to neural networks are different also the applied neural network (NN) architectures differ. The NN models used in the current paper are not taken directly from the literature but are rather inspired by some models and tailored to the particular problem of delamination identification.
	We have rewritten last two paragraphs of the introduction to be more clear about it:
    }

	\emph{In our previous research work [45], we have developed a deep learning-based
		semantic segmentation model with a fully convolutional neural network (FCN)
		to identify delamination in CFRP.	
		The full wavefield frames were
numerically generated to resemble measurements acquired by SLDV.
		Each wavefield was corresponding to one delamination scenario.
		Next, the root mean square (RMS) technique
was applied on the full wavefield frames giving one image per delamination scenario.
		Consequently,
the developed deep neural network models were trained on a one-to-one prediction scheme (RMS image to damage map).
	    The predicted damage map consisted of two classes: undamaged and damaged indicating the location, size and shape of the delamination.}
	
		\emph{In this work, we took a further step in which the full wavefield frames of
		propagating Lamb waves were directly utilised in an end-to-end
deep learning model.
		It means that the mid-step consisting of the calculation of RMS has been omitted.
		Accordingly, a many-to-one
prediction scheme was used in the proposed deep learning models (many input frames to damage map).
		In other words, a sequence of full wavefield frames (animation) is fed into the proposed deep learning models.
		These models are inspired by convolutional long short-term memory (ConvLSTM) architectures and tailored to the particular problem of delamination identification.
		Similarly to our previous research work [45] two classes (damaged and undamaged) were defined in the pixel-wise segmentation problem.}
	
	    \emph{To the best of our knowledge, it is the first
implementation of deep neural networks utilising Lamb wave propagation animations
for damage imaging with semantic segmentation. 
	    The proposed models
showed excellent capabilities to identify the delamination in the numerically
generated dataset.
	    Moreover, the developed models can generalise so that they could be used for delamination
identification in the real world scenarios.
    	This is confirmed through the experiment on CFRP plates with single and multiple delaminations.}
    
	\newpage
	\textbf{Reviewer: 3} \\
	The manuscript "Deep learning approach for delamination identification using animation of Lamb waves" generally tackles an interesting problem to the NDT community, and the results look promising. 
	However, as already pointed out in previous reviews, the applicability of the presented approach in practice remains somewhat questionable: 
	
	\textcolor{Cyan}{
		\textbf{Response:}
		We partially agree with the concerns risen by the reviewer that the applicability of the proposed method is limited.
	    For example, the access to the surface of the inspected structural element must be provided.
        But, it is the same problem as with other methods which utilise full wavefields [12-14].
        The other limitation is that numerical simulations must be performed first in which material properties must be similar to the material of the inspected structure.}
	
	\begin{enumerate}
		\item The currently required number of measurements appears to be of the order of magnitude of that of typical c-scans.
		
		\textcolor{Cyan}{
			\textbf{Response:}
			We are not sure if the Reviewer means the number of spatial scan points or the number of scans?
			In the former case, the spacing of the grid is strictly related to the shortest wavelength of propagating Lamb wave modes. According to Nyquist parameter, at least two points per wavelength are required but often more points are used to get smooth visualisation of propagating waves. Hence, the same number of points is required regardless of the applied measuring technique (SLDV, air-coupled ultrasonics, Shearography).
			If the Reviewer means the number of c-scans, it is required only one. The 475 wavefields corresponding to 475 delamination scenarios were calculated numerically and used for deep neural network training.
		}
		\item It would also likely require partial disassembly of the structure of interest, or an extremely complicated/costly setup. 
		
		\textcolor{Cyan}{
			\textbf{Response:}
			We agree with the Reviewer that the setup is costly and partial disassembly of the inspected structure may be required.
			However, we are focusing solely on signal processing methods of full wavefield data and their accuracy for delamination identification rather than the implementation of SLDV for scanning structures.
			Nevertheless, SLDV scanning has already found application in the automotive industry for vibration measurements.
		}
	\end{enumerate}

    \textcolor{Cyan}{
    	\textbf{Response:}
    	In order to address the above-mentioned issues we modified the last paragraph of conclusions by mentioning limitations of the proposed method.  
    }

   \emph{It should be added that by using proposed models much better accuracy was
obtained on experimental data in comparison to previously developed FCNDenseNet
models}.
   
   \emph{However, there are several limitations of the SLDV measurement technique which is used for full wavefield acquisition.
   The measurements by using SLDV are stationary and time-consuming.
   Therefore, the proposed technique is more appropriate for NDT than SHM.
   However, it is probable in the future, as
laser technology progresses, that the process of data acquisition will be possible in
an array of points instead of a single point, which will considerably decrease the measurement time.
   It should be added, that the measurement time can also be reduced by using fewer points in the spatial grid along with the compressive sensing approach.
   Another issue with SLDV measurements is that the laser needs access to the surface of the inspected structure which may require partial disassembly of the structure.
   }

	\emph{The limitation related to the developed deep learning model is that the material properties of the inspected structure have to be approximately known in order to simulate the dataset for training.} 
	
	\vspace{5mm}
   
	At the very least, the authors should investigate whether a sparser grid would be sufficient to produce results of similar quality. 
	
	\textcolor{Cyan}{
		\textbf{Response:}	
    Thank you for pointing that out. We are currently working on this problem but it is out of the scope of this paper. Definitely, lower density grid can be applied with similar accuracy. Also, compressive sensing can be used to reduce the measurement time by using SLDV. We mentioned it briefly in the revised version of the conclusions.
	}

	\vspace{5mm}

	Furthermore, several additional items need to be addressed as detailed below, and I cannot recommend this paper for publication in its current form.
	
	While the specific approach presented in this manuscript may have not been applied by other researchers, as the authors pointed out themselves, there is an abundance of ANN/CNN/DNN literature that focuses on guided wave-based damage detection. 
	Thus, the overall novelty of this manuscript may be somewhat overstated. And while the authors claim that their approach is "better than by using other methods", no quantitative comparison was presented. 

	\textcolor{Cyan}{
		\textbf{Response:}
	We are sorry but we cannot agree. First of all, there are indeed several papers related to ANN application for damage detection in which guided wave signals measured by sensors are used. There are much fewer papers related to the application of CNN/DNN for damage detection, localisation and size estimation. But there are almost no papers related to full wavefield processing. This raises the problem of quantitative comparison. There are no data available, benchmark datasets are nonexistent and codes are not provided.
	We want to be transparent with our research so that we provide the dataset. Our code is also available on GitHub so that researchers can reproduce the results and use it to compare with their methods. 
	The code for Model-I and Model-II is available at \url{https://github.com/IFFM-PAS-MISD/aidd/tree/master/src/models}.
	Secondly, a quantitative comparison between results obtained by the methods described in the current paper and our previous study [45] is provided. We even used the same experimental example so that the results can be directly compared. Also in our previous studies comparisons with other classic full wavefield signal processing methods such as RMS and adaptive wavenumber filtering method are given. The results obtained by the classic full wavefield signal processing methods were worse than the deep learning methods so we are not repeating all results here, only the best from previous studies.
	}

	\vspace{5mm}
	
	The authors seem to have implemented a number of required improvements as suggested in previous reviews, however, several points have only been addressed fairly vaguely. 
	For example, a "size error metric" has been introduced and numerical values are provided. 
	However, no definition of such metric is given. 
	\begin{itemize}
		\item It is not even clear if a large or small number is better in this context, i.e. is \(100\%\) the true size, or is \(0\%\) no size deviation? It also remains unclear whether the metric would produce a "perfect" value for a defect of the correct size but completely incorrect shape. 
			\\ \\
		\textcolor{Cyan}{
			\textbf{Response: }
			Thank for your constructive comment.
			The percentage area error metric (\(\epsilon\)) was modified and further explained as follows:\\	}
		\emph{Additionally, the percentage area error ($\epsilon$) depicted in Eqn.~\ref{eqn:mean_size_error} was utilised to evaluate the performance of the models:
	\begin{equation}\tag{8}
		\epsilon=\frac{|A-\hat{A}|}{A} \times 100\%
		\label{eqn:mean_size_error}
	\end{equation}
	where \(A\) and \(\hat{A}\) refer to the area in mm\textsuperscript{2} of the damage class in the ground truth and the predicted output, respectively.
	This metric can indicate how close the area of the predicted delamination is to the ground truth.
	Accordingly, the lower the value of ($\epsilon$), the higher the accuracy of the identified damage.}	
		\\ \\
		\item Also, why is the localization error discussion not included in the manuscript?
			\\ \\
		\textcolor{Cyan}{
			\textbf{Response:}
		Thank you for pointing this out. The paragraph was updated in the text as follows:}\\
		\emph{Furthermore, for all predicted outputs the delamination localisation error (the distance between delamination centres of the GT and the predicted output) was less than (\(0.001\%\)), hence, it was not considered in the discussion section.}
		\\ \\
	\end{itemize}
	
	Many details of the simulations and the discussion thereof have been omitted. 
	\textcolor{Cyan}{
		\textbf{Response:}
	We apologise for this omission. However, it is mostly repeating the description from our previous paper and we thought that it is unnecessary. The data is also available in the dataset description in zenodo [48]. We supplemented the appropriate data in the updated version of the paper.}
	
	\begin{itemize}
		\item What are the applied material parameters?
			\\ \\
		\textcolor{Cyan}{
			\textbf{Response:}
		The material is typical cross-ply CFRP laminate. The properties of single ply are as follows [GPa]:
	    \(C_{11} = 52.55, \, C_{12} = 6.51, \, C_{22} = 51.83, C_{44} = 2.93, C_{55} = 2.92, C_{66} = 3.81\). The assumed mass density was 1522.4 kg/m\textsuperscript{3}}
		\\ \\
		\item What are the stacking sequences?
			\\ \\
		\textcolor{Cyan}{
			\textbf{Response:}
		In the numerical calculations a simple model of stacking sequence [0/90]\(_4\) was used.}
		\\ \\
		\item How do these compare to the real specimens used in the experiments?
			\\ \\
		\textcolor{Cyan}{
			\textbf{Response:}
		Thank you for this important question. The specimens were made from CFRP of similar parameters as in numerical simulations. However, plain weave fabric reinforcement was used in specimens in comparison to unidirectional stacked plies in the numerical model. Overall, the aim for performing numerical simulations was to have similar wave front patterns and wavelengths. However, elastic constants identification was not performed. As a result, discrepancies in wavelengths occurs. The wavelength in numerical wavefield was about 21.2 mm and in experimental case about 19.5 mm.}
		\\ \\
		\item What are the other parameters of the numerical model?
			\\ \\
		\textcolor{Cyan}{
			\textbf{Response:}
		The total wave propagation time was set to 0.75 ms so that the guided wave can propagate to plate edges and back to the actuator twice.
	    }
		\\ \\
		\item What is the sampling frequency, and why 512 frames?
			\\ \\
		\textcolor{Cyan}{
			\textbf{Response:}
		The number of time integration steps was 150000 which was selected for stability of the central difference scheme. It translates to sampling frequency of 200 MHz.}
		\\ \\
		\item How does the spatial resolution compare to the smallest expected wave length? Is a 1px/mm resolution sufficient for practical implementations?
			\\ \\
		\textcolor{Cyan}{
			\textbf{Response:}
			As the Reviewer pointed out the resolution of measurement grid should be selected according to the shortest wavelength. In our experimental case it is about 19.5 mm. Considering that we used 333 points along the edge of the plate of length 500 mm it gives 13 points per wavelength. However, the grid is square and the longest distance between points is along the diagonal so correction should be taken which gives 9 points along the diagonal. In order to have good wave crests representation usually at least 5 nodes per wavelength are required.
			In conclusion, 1px/mm resolution is sufficient for most practical implementations.
		}
		\\ \\
	\end{itemize}

	Within the produced 475 datasets, details on the differences are not presented. 
	\begin{itemize}
		\item Are size and location varied? If so by how much? What about the shape of the defect?
			\\ \\
		\textcolor{Cyan}{
			\textbf{Response:}
		We apologise for the omission of this important detail. These parameters were given in our previous paper. We added missing information to the dataset description along with illustration.
	   }
		
		\emph{
			The following random factors were used in simulated delamination scenarios:
			\begin{itemize}
				\item delamination geometrical size	(ellipse minor and major axis randomly selected from the interval \(\left[10 \, \textrm{mm}, 40\, \textrm{mm}\right]\)),
				\item delamination angle (randomly selected from the interval \( \left[ 0^{\circ}, 180^{\circ} \right]\)),
				\item coordinates of the centre of delamination (randomly selected from the interval \(\left[0\, \textrm{mm}, 250\, \textrm{mm} -\delta \right]\) and \( \left[250\, \textrm{mm}+\delta, 500\, \textrm{mm} \right] \), where \(\delta = 10\, \textrm{mm}\)).
			\end{itemize}
		}
		\item How was it determined that 475 are sufficient?
			\\ \\
		\textcolor{Cyan}{
			\textbf{Response:}
		In general, the larger the dataset, the better generalisation capabilities can be achieved by deep learning models.
	    However, the computation time of large number of cases is still long.
        Hence, a compromise was needed.
        The convergence of the developed models confirmed that 475 cases were sufficient.}
		\\ \\
	\end{itemize}
    
	For the measurements, more details need to be provided about where the scanning grid was applied in relation to the plate. 
	\begin{itemize}
		\item Was the grid aligned with the plate boundaries? Is this important for the algorithms to work?
			\\ \\
		\textcolor{Cyan}{
			\textbf{Response:}
		Thank you for pointing that out. The measurement grid was aligned with the plate boundaries. It is not important for the algorithm to work as long as the same area is considered in numerical simulations.}
		\\ \\
		\item How is the "upscaling" to 500/512 points realized?
			\\ \\
		\textcolor{Cyan}{
			\textbf{Response:}
		The images were upsampled by using cubic interpolation.
	    We apologise for using inaccurate term.}
		\\ \\
		\item How many time-averages had to be used to reach an acceptable SNR?
			\\ \\
		\textcolor{Cyan}{
			\textbf{Response:}
		We used 10 averages and it was enough to reach an acceptable SNR.
	    But it is frequency dependent.}
		\\ \\
		\item What is the total scanning time for one specimen?
			\\ \\
		\textcolor{Cyan}{
			\textbf{Response:}
		The total scanning time is about 9h 40'.}
		\\ \\
		\item What is the thickness of the Teflon insert?
			\\ \\
		\textcolor{Cyan}{
			\textbf{Response:}
			Thank you for pointing this out.
		The thickness of the Teflon insert is \(250\ \mu\)m.
	    }
		\\ \\
		\item How is ground truth established for experiments?
			\\ \\
		\textcolor{Cyan}{
			\textbf{Response:}
		The teflon inserts were manufactured according to our specification so that their positions and sizes were known.
		The ground truths were prepared manually based on that specification.}
		\\ \\
		\item Have C-Scans been used to verify the size and shape of the delamination?
			\\ \\
		\textcolor{Cyan}{
			\textbf{Response:}
		Unfortunately, we do not have appropriate equipment to conduct ultrasonic c-scans.}
		\\ \\
		\item Why is Case II the most difficult as "delaminations are barely visible" this should be true for all of the specimens (if not, why not?)
			\\ \\
		\textcolor{Cyan}{
			\textbf{Response:}
		Thank you for pointig that out.
	    Within the text it should be rather "delamination reflections are barely visible". It is because the measurements are conducted on the bottom surface of the plate and the dalaminations in the cross-section are farther away from the bottom surface than in other specimens (III and IV).
        }
		\\ \\
	\end{itemize}

	The two presented models should be compared in the conclusions. 
	It also didn't become clear why the RMS approach is presented. 
	Is this part of the analysis or a separate analysis for comparison? 
	This may need to be addressed again in the conclusions.
		\\ \\
	\textcolor{Cyan}{
		\textbf{Response:}
	Thank you for your valuable remark.
	The developed deep learning models were explained in section 2.3, further, in the results and discussions section, the results of both models were presented and compared accordingly. 
	We have added one more schematic illustration and separate section to better explain the need for calculation of RMS.
    }
	\\ \\	
	The manuscript suffers from a substantial amount of minor and major language errors.
		\\ \\
	\textcolor{Cyan}{
		\textbf{Response:}
		We have reread the paper carefully and corrected language errors.
	}
	\\ \\
	\newpage
	\textbf{Reviewer: 4}  \\
	I was not sure whether I was involved in the review since the first round, so I assume I just joined the third round (for 2nd revision).
	Based from the comments I tracked from the first round and second round, it seems that the authors have sufficiently addressed the issues.
	What I would like to point out is however, what is the major difference of the content of this paper compared to the previous work?
	Full Wavefield Processing by Using FCN for Delamination Detection, J Mechanical Systems and Signal Processing, Volume 153, 15 May 2021, 107537.
	It seems that both works have a big intersection. The only difference I could see here is that the utilization of ConvLSTM instead of ConvNet.	
		\\ \\
	\textcolor{Cyan}{
		\textbf{Response:}
	Thank you for your comment. The differences were explained already to the Reviewer 2. We repeat them here for your convenience.
     It should be noted that the dataset used in our previous paper is completely different from the one used in the current paper. In the previous paper, the dataset consists of RMS images computed from full wavefields. It means that there is only one image per delamination scenario. In the current paper, several images per delamination scenario in the form of propagating wavefields are used. Therefore, inputs for neural networks are in the form of a single image (previous paper) and several images (current paper). It should be noted, however, that both datasets were created at the same time by using the time domain spectral element method with the same random delamination arrangements (It is explained in the \emph{Dataset} section).
    Moreover, since inputs to neural networks are different also the applied neural network (NN) architectures differ. The NN models used in the current paper are not taken directly from the literature but are rather inspired by some models and tailored to the particular problem of delamination identification.
    We have rewritten last two paragraphs of the introduction to be more clear about it:
}

\emph{In our previous research work [45], we have developed a deep learning-based
semantic segmentation model with a fully convolutional neural network (FCN)
to identify delamination in CFRP.	
The full wavefield frames were
numerically generated to resemble measurements acquired by SLDV.
Each wavefield was corresponding to one delamination scenario.
Next, the root mean square (RMS) technique
was applied on the full wavefield frames giving one image per delamination scenario.
Consequently,
the developed deep neural network models were trained on a one-to-one prediction scheme (RMS image to damage map).
The predicted damage map consisted of two classes: undamaged and damaged indicating the location, size and shape of the delamination.}

\emph{In this work, we took a further step in which the full wavefield frames of
propagating Lamb waves were directly utilised in an end-to-end
deep learning model.
It means that the mid-step consisting of the calculation of RMS has been omitted.
Accordingly, a many-to-one
prediction scheme was used in the proposed deep learning models (many input frames to damage map).
In other words, a sequence of full wavefield frames (animation) is fed into the proposed deep learning models.
These models are inspired by convolutional long short-term memory (ConvLSTM) architectures and tailored to the particular problem of delamination identification.
Similarly to our previous research work [45] two classes (damaged and undamaged) were defined in the pixel-wise segmentation problem.}

\emph{To the best of our knowledge, it is the first
implementation of deep neural networks utilising Lamb wave propagation animations
for damage imaging with semantic segmentation. 
The proposed models
showed excellent capabilities to identify the delamination in the numerically
generated dataset.
Moreover, the developed models can generalise so that they could be used for delamination
identification in the real world scenarios.
This is confirmed through the experiment on CFRP plates with single and multiple delaminations.}
	\\ \\
\end{document}