% This is samplepaper.tex, a sample chapter demonstrating the
% LLNCS macro package for Springer Computer Science proceedings;
% Version 2.20 of 2017/10/04
%
\documentclass[runningheads]{llncs}
%
\usepackage[top=5cm, bottom=5.6cm, left=4.5cm, right=4.2cm]{geometry}
\usepackage{graphicx}
\usepackage{array}
%% The amssymb package provides various useful mathematical symbols
\usepackage{amsmath,amssymb,bm}
%\usepackage[dvips,colorlinks=true,citecolor=green]{hyperref}
\usepackage[colorlinks=true,citecolor=green]{hyperref}
%% my added packages
\usepackage{float}
\usepackage{csquotes}
\usepackage{verbatim}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{booktabs} % for nice tables
\usepackage{csvsimple} % for csv read
%\usepackage[outdir=//odroid-sensors/sensors/aidd/reports/journal_papers/MSSP_Paper/Figures/]{epstopdf}
%\usepackage{breqn}
\usepackage{multirow}
% matrix command 

\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}
% Used for displaying a sample figure. If possible, figure files should
% be included in EPS format.
%
% If you use the hyperref package, please uncomment the following line
% to display URLs in blue roman font according to Springer's eBook style:
% \renewcommand\UrlFont{\color{blue}\rmfamily}

\makeatletter
\renewcommand\paragraph{\@startsection{paragraph}{4}{\z@}%
                                    {3.25ex \@plus1ex \@minus.2ex}%
                                    {-1em}%
                                    {\normalfont\normalsize\bfseries}}
\makeatother

\graphicspath{{figures/}}

\begin{document}
%
\title{Delamination identification using global convolution networks}
%
%\titlerunning{Abbreviated paper title}
% If the paper title is too long for the running head, you can set
% an abbreviated paper title here
%
\author{Abdalraheem Ijjeh\inst{1}\orcidID{0000-0003-0654-4562} \and
Pawel Kudela\inst{1}\orcidID{0000-0002-5130-6443}}
%\and Third Author\inst{3}\orcidID{2222--3333-4444-5555}}
%
% \authorrunning{F. Author et al.}
% First names are abbreviated in the running head.
% If there are more than two authors, 'et al.' is used.
%
\institute{Institute of Fluid Flow Machinery, Polish Academy of Sciences, Poland
\email{aijjeh@imp.gda.pl}\space \email{pk@imp.gda.pl}}
%
\maketitle              % typeset the header of the contribution
%
%\begin{abstract}
\paragraph{Abstract.}
In this paper, we present a deep learning technique for image segmentation known as the global convolutional network, which we employ for delamination detection and localisation in composite materials.
The model was trained and validated on our previously generated dataset that resembles full wavefield measurements acquired by a scanning laser Doppler vibrometer.
Additionally, the model was verified on experimentally acquired data with a Teflon insert representing delamination, showing that the developed model can be used for delamination size estimation.
The achieved accuracy in the current implemented model surpasses the accuracy of previous models with an improvement of up to $22.47\%$ for delamination identification.


\keywords{Lamb waves.  Structural health monitoring.  Semantic segmentation. Delamination identification. Deep learning. Fully convolutional neural networks.}
%\end{abstract}
%
\\[2em]

% \end{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Composite materials have gained popularity in recent years in a variety of industries, including aerospace, cars, construction, marine, and others, due to their lightweight, good fatigue, and corrosion resistance.
Composite materials, on the other hand, may suffer from matrix cracks, fibre breakage, debonding, and delamination~\cite{ip2004delamination}~\cite{smith2009composite}
Delamination (the separation of layers in a laminate composite) is one of the most dangerous of these defects since it occurs largely below the top surfaces and is barely visible~\cite{Cai2012}.

Delamination in composite materials can be caused by a variety of causes, including manufacturing flaws, notches, and impact events.
As a result, delamination can decrease the strength and the performance of structures.
To avoid such outcomes, real-time delamination detection is crucial.
In order to monitor the integrity of engineering structures, numerous physics-based approaches for damage detection and localization have been developed in the disciplines of structural health monitoring (SHM) and non-destructive testing (NDT).

Guided waves, namely Lamb waves, are used in a well-known physics-based technique in the field of SHM for damage identification.
Lamb waves are elastic waves that propagate within thin plates and shells that are restricted by stress-free surfaces~\cite{mitra2016guided}.
Furthermore, Lamb waves are notable for their strong sensitivity to discontinuities (cracks, delaminations) and low amplitude loss, particularly in metallic structures~\cite{Keulen2014}.

Lamb waves can be generated by using an array of PZT transducers to excite the examined structure, and then the reflected waves from damage can be registered.
After that, a damage influence map is generated.
The number of sensing points determines the accuracy of the damage influence map, which indicates damage location.
As a result, damage localization resolution can be low.
Therefore, a Scanning Laser Doppler Vibrometer (SLDV) is used to measure Lamb waves in a dense grid of points over the structure under investigation.
Full wavefield propagation measurements are obtained, resulting in high-resolution damage influence maps.
Damage detection techniques that use full wavefield signals can accurately estimate the size and location of damage~\cite{Girolamo2018a}.

Conventional machine learning techniques such as support vector machine (SVM) \cite{noori2010application}, K-Nearest Neighbor (KNN)~\cite{Vitola2017}, decision tree~\cite{Mariniello2020}, particle swarm optimization (PSO)~\cite{Khatir2018}, and principle component analysis (PCA)~\cite{wang2014principal}
have proven to be capable of detecting damage in the structures under investigation.
However, when dealing with large amounts of data, such techniques have drawbacks because they necessitate a complex feature engineering computation~\cite{Gulgec2019}, which also requires a high level of experience and abilities to extract damage-sensitive features for specific SHM applications.
As a result, a data-driven technique for SHM applications has emerged in the form of deep learning (DL) end-to-end methods in recent years, with the process of feature engineering and classification done automatically.

Due to rapid advancements in computer hardware and software, big data, and cloud-based computations, DL techniques in many SHM disciplines have gained increased attention in recent years~\cite{Azimi}.
For SHM of civil engineering structures, many DL-based approaches were used for damage detection and localization~\cite{Cha2018}~\cite{Kong2018}, corrosion detection~\cite{Atha2018}, and concrete crack detection~\cite{Dung2019}.


Several DL approaches for guided wave-based damage identification and localization are discussed in the following.
For damage detection in curved composite panels, Chetwynd et al.~\cite{Chetwynd2008} developed a multi-layer perceptron MLP network.
A force applicator with a circular tip loaded with a mass was used to simulate the damage.
A PZT transducer array was also used to generate and detect Lamb waves as they propagated through the panel.
In addition, for each Lamb wave response, a novelty index was calculated and compared to specific threshold values.
As a result, if the index exceeds the threshold, it indicates that the structure has a defect.
The generated novelty indices were sent into the MLP network, which performed two operations: classification and regression.
The classification network was created to identify three convex parts of the panel and determining whether or not it was damaged.
The regression network, on the other hand, can identify the specific area of the damage.

Melville et al.~\cite{Melville2018} developed a CNN model for damage state prediction based on full wavefield measurements of thin aluminum plates.
When compared to the SVM, the model showed enhanced accuracy in terms of damage (\(99.98\%\)) compared to \(62\%\).

For signal classification utilising Lamb waves, Ewald et al.~\cite{Ewald2019} developed a CNN model named DeepSHM.
The model uses response signals acquired by sensors to give an end-to-end strategy for SHM.
The authors also used the wavelet transform to preprocess response data in order to generate the wavelet coefficient matrix (WCM), which was then input into the CNN model.

This work builds on our earlier work~\cite{Ijjeh2021}, in which we developed a DL model trained on a numerically generated dataset that highly resembles SLDV measurements with high resolutions.
The developed DL method was compared to a conventional damage methodology, the adaptive wave number filtering~\cite{Kudela2015}~\cite{Radzienski2019a}.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Current SHM approaches can accurately localize impact events~\cite{Ciampa2012} and damage~\cite{Nokhbatolfoghahai2020}.
With a sparse array of sensors, however, determining the size and shape of damage is challenging.
To solve this difficulty, full wavefield ultrasonic techniques can be used locally to assess damage severity and then to estimate damage prognosis.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Hence, it motivates us to use the full wavefield of Lamb waves propagation in a DL image segmentation approach to achieve a precise delamination detection and size estimation.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In this paper, we present a DL model for semantic image segmentation that can be used in CFRP to identify delamination, localize it, and estimate its size.
To demonstrate its generalisation ability, the model was evaluated on both numerical and experimental data.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Methodology}
\label{methodology}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Dataset}
Our previously created dataset~\cite{Ijjeh2021} was utilized to train the DL model in this work.
Furthermore, the produced dataset resembles SLDV transverse velocity measurements (perpendicular to the plate surface).
The dataset includes 475 simulations of the full wavefield of propagating Lamb waves in a CFRP plate with eight layers and a total thickness of (3.9) mm.


The delamination in the model is represented by two shell layers that are connected only at the boundary of the damaged area. 
These elements are computed by considering the corresponding, reduced, number of laminae, and their offset form the neutral axis of the plate. 
This approach, which is detailed in~\cite{Kudela2009}, has the advantage of preserving the computational efficiency of the model in comparison to solid elements, as the increase in nodes is usually modest. 
Additionally, the beneficial property of the mass matrix, which is diagonal, are maintained. 
%%%%%%%%%%%%%%%
Each simulated case represents the interaction of Lamb waves with a single   delamination which was simulated by considering random factors as spatial location, size, and orientation.
The plate with overlayed 475 delamination cases is shown in Fig.\ref{fig:rand_delaminations}. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure} [h!]
	\begin{center}
		\includegraphics[scale=1.0]{figure1.png}
	\end{center}
	\caption{The plate with 475 cases of random delaminations.} 
	\label{fig:rand_delaminations}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Each simulated case in the dataset computed from the wave propagation model is a 3D matrix, which holds the amplitudes of the propagating waves at location \((x,y)\) and time \((t)\).
Hence, these matrices can be seen as animated frames at discrete time \(t_k\) of propagating waves.
Moreover, it should be mentioned that the simulated delaminations were located closer to the top surface of the plate.
Accordingly, it is easier to detect delamination by using the simulated full wavefield on the top surface of the plate instead of the bottom surface.
However, to train our various models we applied the more difficult case in which the full wavefield was registered at the bottom surface of the plate.
To enhance the visualisation, the root mean square depicted in Eq.~(\ref{ref:rms}) was applied for the full wavefield frames.
\begin{equation}
	\hat{s}(x,y) = \sqrt{\frac{1}{N}\sum_{k=1}^{N} s(x,y,t_k)^2}
	\label{ref:rms}
\end{equation}
where \(N\) refers to the number of sampling points (\(N=512\)).
Figures~\ref{fig:rmstop} and \ref{fig:rmsbottom} show the result of applying RMS to the full wavefield from the top and bottom surface of the plate respectively.
The dataset consisting of RMS images which were used in this research paper is available online~\cite{Kudela2020d}.
\begin{figure} [h!]
	\centering
	\begin{subfigure}[b]{0.47\textwidth}
		\centering
		\includegraphics[scale=.29]{figure2a.png}
		\caption{top}
		\label{fig:rmstop}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.47\textwidth}
		\centering
		\includegraphics[scale=.29]{figure2b.png}
		\caption{bottom}
		\label{fig:rmsbottom}
	\end{subfigure}
	\caption{RMS of the full wavefield from the top surface of the plate (a) and the bottom surface of the plate (b).}
	\label{fig:rms}
\end{figure} 
\subsection{Data preprocessing}
To enhance the performance of the optimizer during the training process, the colour scale values were normalized to a range of (\(0-1\)) instead of the initial scale which was in a range of (\(0 - 255\)).	
Furthermore, we have applied data augmentation to the dataset by flipping the images horizontally, vertically, and diagonally. 
As a result, the dataset size increased four times -- \(1900\)  images were produced.
We have split the dataset into two portions:  \(80\%\) for the training set and \(20\%\) for the testing set.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Moreover, a K-folds cross-validation method~\cite{Srinivasan2019} was applied to the training set to reduce the overfitting which happens when the model is able to fit on the training data, while it poorly fit on the new unseen data.
In other words, the model only learns the patterns of the training data therefore the model will not generalise well. 
The main advantage of the K-folds method versus a regular train/test split is to reduce the overfitting by utilising data more efficiently as every data sample is used in both training and validation. 
Therefore, by using this technique, we aim to improve the ability of the model to generalise and reduce overfitting.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Semantic segmentation models}
\label{section:semantic_segmentation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
The purpose of utilising deep learning methods is to perform the feature extraction process automatically through feeding the models  of the RMS of the full wavefield images from the bottom surface of the plate as in Fig.~\ref{fig:rmsbottom}.
Therefore, the models will learn to recognise different complex patterns by themselves, consequently identify the delamination. 
In this work, we have performed a comparative study among four deep learning models based on fully convolutional networks (FCN)~\cite{shelhamer2017fully} that aim to perform pixel-wise segmentation by classifying every pixel of the input image as damaged or not. 

FCN is built by stacking convolutional layers in an encoder-decoder scheme, therefore, dense layers are not included in FCN models. 
The idea behind the encoder is to extract condensed feature maps of the input image through downsampling that is performed by applying several convolutions with strides.
The decoder part is responsible for upsampling the condensed features maps to the same size of the original input image by using techniques like transposed convolution with strides and upsampling with interpolation.

For all implemented models in this comparative study, a softmax activation function is used at the output layer.
The softmax function computes the probability of the damaged and undamaged occurrence for every single pixel.
Consequently, the sum of the two probabilities must be one. 
Eqn.~(\ref{softmax}) illustrates the softmax, where \(P(x)_{i}\) is the probability of each target class \(x_{j}\) over all possible target classes \(x_{j}\), C in our case are two classes  (damaged and undamaged).
To predict the label of the detected output (\(y_{pred}\)) that represent the damaged and undamaged probabilities, an \(\mathrm{argmax}\) function is applied to select the maximum probability between both of them.
\begin{equation}
	P(x)_{i} = \frac{e^{x_{i}}}{\sum_{j}^{C} e^{x_{j}}}
	\label{softmax}
\end{equation} 
\begin{equation}
	y_{pred} = \mathrm{argmax_{i}}\left( P(x)_{i} \right)
	\label{argmax}
\end{equation}
In deep learning models, choosing a suitable loss function is an important task because it measures how good the model is performing.
In our implemented models, we have applied the categorical cross-entropy (CCE) loss function, which is also called \enquote{softmax loss function}.
Eqn.~(\ref{CCE}) illustrates the CCE, where \( P(x)_{i}\) is the softmax value of the target class. 
\begin{equation}
	CCE = -\log\left( P(x)_{i} \right)
	\label{CCE}
\end{equation}

Additionally, it is also important to select a proper accuracy metric of the model, therefore, we have applied intersection over union (IoU) as our accuracy metric. 
IoU is estimated by determining the intersection area between the ground truth and the predicted output.
In this work, we have two classes (damaged and undamaged), therefore the IoU is computed by taking the IoU for each class and average them.
The IoU metric is defined as in Eqn.~\ref{IoU}:
\begin{equation}
	IoU = \frac{Intersection}{Union} = \frac{\hat{Y} \cap Y}{\hat{Y} \cup Y} 
	\label{IoU}
\end{equation}
Where \(\hat{Y}\) represents the predicted vector of damaged and undamaged values, and \(Y\) represents the vector of ground truth values.
The IoU can be calculated by multiplying the predicted output with its ground truth value to find the intersection, then it is divided over the union which can be calculated by counting all pixel values greater than zero of the predicted output and its ground truth.
Furthermore, Adam optimizer was applied as our optimization function in order to increase the IoU and to reduce the loss during the training.

In the next subsections, we present four FCN models for pixel-wise semantic segmentation to detect and localise delaminations.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Global Convolutional Network}
Global Convolutional Network (GCN) proposed by Peng et al. 
~\cite{Peng2017} addressed the importance to have large kernels for both 
localisation and classification for semantic segmentation to enlarge 
respective fields.
However, a contradiction arises when performing classification and localisation 
tasks. 
For instance, classification tasks require the models to be invariant for 
different transformations such as rotation and translation.
On the other hand, localisation tasks require the models to be sensitive for 
any transformation, to accurately assign each pixel for its semantic category.
Accordingly, to solve this contradiction, two design principles were suggested: 
\begin{enumerate}
	\item For the classification task, in order to improve the capability of 
	the model to handle different transformations, a large kernel size must be 
	used to enable dense connections between feature maps and per-pixel 
	classifiers.
	\item For localisation task, the model must be fully convolutional. 
	Additionally, fully connected or global pooling layers are not applied as 
	these layers will discard the localisation information. 
\end{enumerate}

Figure~\ref{fig:gcn} presents the proposed GCN module for semantic segmentation 
utilised for delamination identification.
\begin{figure} [h!]
	\begin{center}
		\includegraphics[scale=1.0]{figure8.png}
	\end{center}
	\caption{Global Convolution Network whole architecture.} 
	\label{fig:gcn}
\end{figure}
As shown in the Fig.~\ref{fig:gcn}, a residual network was utilised as a backbone for 
feature maps extraction, the residual block is shown in 
Fig.~\ref{fig:res_gcn_br}a.
After each residual block, a GCN block is inserted  
(Fig.~\ref{fig:res_gcn_br}b), which employs a combination of \((1\times 
k)\)+\((k\times 1)\) and \((k\times 1)\)+\((1\times k)\) convolutions which 
enables a dense connections within a large \((k\times k)\) region in the 
feature map.
In this work, we implemented the model with \(k=7\).
This is followed by a boundary refinement (BR) block shown in Fig.~\ref{fig:res_gcn_br}c, which can be considered as an additional residual block to refine the predictions near the object boundaries ended up generating a lower resolution score map. 
Furthermore, the upsampling operation is done recursively, it upsamples the low 
resolution score maps then concatenate it with a higher one to produce a new 
score maps.
The deconvolution operation is repeated until the original image size is 
obtained.
\begin{figure} [ht!]
	\begin{center}
		\includegraphics[scale=1.0]{figure9.png}
	\end{center}
	\caption{(a) Residual block, (b) Global Convolution Network block, (c) 
		Boundary Refinement} 
	\label{fig:res_gcn_br}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Results and discussions}
\label{section:results_and_discussions}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
In this section, five DL models of semantic segmentation approach including  Res-UNet, VGG16 encoder-decoder, FCN-DenseNet, PSPNet, and GCN were evaluated on exemplary three damage scenarios of an RMS of the numerically calculated full wavefield interpolated at the bottom surface of the plate in order to identify the delamination.
Additionally, an experimental scenario was also used to evaluate the performance of the models to show the DL capabilities of generalization.
For each model, the mean and the max \(IoU\) are calculated and presented as a metric of comparison.
Moreover, the Accuracy of classification, Precision, Recall, and F1 score were calculated for each model.
%\begin{equation}
%	\rm Accuracy\ = \frac{TP+TN}{(Total\ number\ of\ tested\ samples)}
%	\label{accuracy}
%\end{equation}
%
%\begin{equation}
%	\rm Pricision\ =\frac{TP}{TP+FP}
%	\label{pricisoin}
%\end{equation}
%\begin{equation}
%	\rm Recall\ = \frac{TP}{TP+ FN}
%	\label{recall}
%\end{equation}
%\begin{equation}
%	\rm F1 score =\frac{2 \times (Pricision\times Recall)}{(Pricision + Recall)} 
%	\label{f1_score}
%\end{equation}
%where the Positive/Negative refers to the predicted output as (damage or non-damage) respectively, True Positive (TP) and True Negative (TN)  represent the correct classification, and the False Positive (FP) and False Negative (FN) represent the incorrect classification.

In this work, all semantic segmentation models were implemented and trained with Keras API~\cite{chollet2015keras} running on top of TensorFlow.
Further, we have replaced the previous NVIDIA RTX2080 GPU utilised in our work~\cite{Ijjeh2021} with a superior NVIDIA Tesla V100 GPU with \(32\)GB memory that enables us to increase the total number of learnable parameters of the DL models that will allow them to learn and extract more features. 
For training purposes, we have used the K-fold cross-validation technique with five folds. 
Accordingly, each model has trained for \(5\) iterations. 
For each iteration, we calculated the mean accuracy of all folds.
Further, the number of epochs equals \(20\) per iteration.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Numerical scenarios}
In the following, three scenarios of numerical data regarding delamination of different locations, shapes, and angles are presented. 
The first exemplary delamination scenario is shown in Fig.~\ref{fig:softmax_448}. 
The delamination is located at the left edge of the plate, and it is surrounded by a line to represent its shape and location as shown in Fig.~\ref{fig:RMS_flat_shell_Vz_448}.
Figures~\ref{fig:unet_pred_448}-~\ref{fig:gcn_pred_448} show the predicted output of the Res-UNet, VGG16 encoder-decoder, PSPNet, FCN-DenseNet and GCN models, respectively. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
All models properly indicate the location of the delamination. 
Moreover, pixels related to delamination location are clustered into a single spot without any additional noise. 
VGG16 encoder-decoder and GCN models better visually resemble the actual shape of the delamination than other models.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[!ht]
	\centering
	\begin{subfigure}[b]{0.47\textwidth}
		\centering
		\includegraphics[scale=1.0]{figure10a.png}
		\caption{RMS bottom with label}
		\label{fig:RMS_flat_shell_Vz_448}
	\end{subfigure}
	\begin{subfigure}[b]{0.47\textwidth}
		\centering
		\includegraphics[scale=1.0]{figure10f.png}
		\caption{GCN}
		\label{fig:gcn_pred_448}
	\end{subfigure}
	\caption{First delamination scenario based on numerical data}
	\label{fig:softmax_448}
\end{figure} 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
In the second delamination scenario, shown in Fig.~\ref{fig:385_softmax}, the delamination is located at the upper left corner of the plate, and it is surrounded by an ellipse to represent its shape and location as shown in Fig.~\ref{fig:RMS_flat_shell_Vz_385}.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
This is the most challenging damage scenario because of reflections coming from plate edges overshadows reflections from damage.
As a result, changes in RMS patterns are barely visible.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Figures~\ref{fig:Unet_Pred__softmax_385} -~\ref{fig:gcn_pred_385} show the predicted output of the Res-UNet, VGG16 encoder-decoder, PSPNet, FCN-DenseNet and GCN models, respectively. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
All models perform reasonably well, considering the difficult damage scenario.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[!ht]
	\centering
	\begin{subfigure}[b]{0.47\textwidth}
		\centering
		\includegraphics[scale=1.0]{figure11a.png}
		\caption{RMS bottom with label}
		\label{fig:RMS_flat_shell_Vz_385}
	\end{subfigure}

	\begin{subfigure}[b]{0.47\textwidth}
		\centering
		\includegraphics[scale=1.0]{figure11f.png}
		\caption{GCN}
		\label{fig:gcn_pred_385}
	\end{subfigure}
	\caption{Second delamination scenario based on numerical data}
	\label{fig:385_softmax}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
The third delamination scenario is shown in Figure~\ref{fig:475_softmax}. 
The delamination is located at the upper middle of the plate and it is surrounded by an ellipse to represent its shape and location as shown in Fig.~\ref{fig:RMS_flat_shell_Vz_475}.
Figures~\ref{fig:Unet_Pred__softmax_475} -~\ref{fig:gcn_pred_475} show the predicted output of the Res-UNet, VGG16 encoder-decoder, PSPNet, FCN-DenseNet and GCN models, respectively. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
In this case, the elliptical shape of delamination is best preserved by Res-UNet and FCN-DenseNet. 
However, the highest value of IoU is obtained by GCN (see Table~\ref{tab:table_numerical_scenarios}).
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[!ht]
	\centering
	\begin{subfigure}[b]{0.47\textwidth}
		\centering
		\includegraphics[scale=1.0]{figure12a.png}
		\caption{RMS bottom with label}
		\label{fig:RMS_flat_shell_Vz_475}
	\end{subfigure}
	\begin{subfigure}[b]{0.47\textwidth}
		\centering
		\includegraphics[scale=1.0]{figure12f.png}
		\caption{GCN}
		\label{fig:gcn_pred_475}
	\end{subfigure}	
	\caption{Third delamination scenario based on numerical data}
	\label{fig:475_softmax}
\end{figure}

The \(IoU\) values for all models regarding the predicted delamination are presented in Table.~\ref{tab:table_numerical_scenarios}.
For the first and third scenarios, the GCN model has the highest \(IoU\) compared to the other models, and for the second scenario, the VGG16 encoder-decoder model has the highest \(IoU\) compared to the other models.
Further, in all models, the predicted outputs have no noise regarding delamination identification.
\begin{table}[]
	\centering
	\caption{\(IoU\) of Numerical scenarios}
	\label{tab:table_numerical_scenarios}
	{
		\begin{tabular}{cccc}\hline
			Model & 1st scenario & 2nd scenario & 3rd scenario \\ \hline 
			GCN & \(0.791\) & \(0.696\) & \(0.875\) \\ \hline
		\end{tabular}
	}
\end{table}
Table~\ref{tab:table_iou} presents the mean and maximum values of \(IoU\) calculated for the previously unseen numerical test set (380 cases) for all models.
Table~\ref{tab:table_iou} shows that all models have a relatively high \(IoU\), indicating their ability to detect and localise the delamination, which is higher compared to the traditional signal processing techniques such as the adaptive wavenumber filtering presented in our previous work~\cite{Ijjeh2021}. 
The mean \(IoU\) for the adaptive wavenumber filtering technique regarding the whole testing samples was \(0.373\) compared to the previous FCN-DenseNet model, which has a mean \(IoU\) of \(0.623\).
\begin{table}[]
	\centering
	\caption{Analysis of numerical data}
	\label{tab:table_iou}
	\begin{tabular}{ccc}\hline
		 & mean \(IoU\) & max \(IoU\) \\ \hline
		GCN & \(0.763\) & \(0.931\) \\ \hline
	\end{tabular}
\end{table}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Further, in Table~\ref{tab:table_performance} the TP, TN, FP, and FN are presented for all models regarding the test set. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Moreover, Table~\ref{tab:evaluation_metric} presents the classification accuracy, precision, recall, and the F1-score values for all models as additional evaluation metrics.
As shown in Table~\ref{tab:evaluation_metric}, all models have high classification accuracy, which indicates that all the presented models are capable of predicting the presence of the delamination in all the numerically generated cases. 
However, the best performance was achieved by GCN.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Moreover, the total number of parameters in any DL model is a sum of the trainable parameters (weights of convolution filters) and non-trainable parameters (biases and pooling filters).
Trainable parameters are continuously updated until we reach the minimum loss value, while the non-trainable parameters are not changed during the whole training process.
Table~\ref{tab:table_parameters} shows the total number of parameters for all implemented models.
Further, the total number of parameters can reflect the computation complexity of the model.
It can be noted that as the number of total parameters increases, the required time for training increases.
\begin{table}[]
	\centering
	\caption{Model parameters}
	\label{tab:table_parameters}
	\begin{tabular}{cc}\hline
		Model &  Total parameters (\(\approx\)) \\ \hline
		GCN & \(36\times 10^6\) \\ \hline
	\end{tabular}
\end{table}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Experimental scenario}
In this scenario, an experimental case of CFRP with Teflon insert as artificial delamination is investigated presented in Fig.~\ref{fig:Exp_ERMS_teflon}. 
Similar to the synthetic data set, we applied a frequency of \(50\) kHz to excite a signal in a transducer placed at the centre of the plate. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
A0 mode wavelength for this particular CFRP material at such frequency is about 20 mm. 
The measurements were performed by Polytec PSV-400 SLDV on a bottom surface of the plate of dimensions 500 by 500 mm. 
The measurement grid spacing was 1 mm and sampling frequency 512 kHz. 
The measured full wavefield was further processed by an energy compensated RMS takes into account wave attenuation. 
The results of such operation are shown in Fig.~\ref{fig:Delamination}.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
The delamination is surrounded by a square frame representing its shape and location. 
Figures~(\ref{fig:unet_exp_7_} - \ref{fig:gcn_exp}) shows delamination prediction maps for Res-UNet, VGG16 encoder-decoder, PSPNet, FCN-DenseNet and GCN models, receptively.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
The performance of the models were evaluated by using IoU metric which takes into account not only damage location but also its shape and size. 
The following results were obtained: the Res-UNet IoU = 0.577, the VGG16 encoder-decoder \(IoU = 0.624\), the
PSPNet \(IoU = 0.488\), the FCN-DenseNet \(IoU = 0.537\) and the GCN \(IoU =
0.723\). 
Similarly to the numerical dataset, the best accuracy was achieved by using GCN.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
As shown, the models are capable of precise detection and localisation of the delamination. 
We can see that the models can identify the delamination with almost free noise, which indicates the models are capable of generalising and detecting the delamination on previously unseen data. 
Considering the presented models were trained only on the numerically generated dataset, the models show high generalisation capability.
The performance of the models can be further improved when they are trained on the experimental and the numerical data, as new features will be learned. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure} [!ht]
	\centering
	\begin{subfigure}[b]{0.47\textwidth}
		\centering
		\includegraphics[scale=1]{figure13a.png}
		\caption{ERMS CFRP Teflon inserted \& Label}
		\label{fig:Delamination}	
	\end{subfigure}	
	\begin{subfigure}[b]{0.47\textwidth}
		\centering
		\includegraphics[scale=1]{figure13f.png}
		\caption{GCN} 
		\label{fig:gcn_exp}
	\end{subfigure}
	\caption{Experimental results}
	\label{fig:Exp_ERMS_teflon}
\end{figure}
\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Acknowledgments}
The research was funded by the Polish National Science Center under grant agreement no 2018/31/B/ST8/00454.
We would like to acknowledge dr Maciej Radzienski for providing the experimental data of full wavefield measured by SLDV.

\bibliography{EWSHM_conference.bib}
\bibliographystyle{unsrt}

\end{document}

