%\documentclass[10pt]{beamer} % aspect ratio 4:3, 128 mm by 96 mm
\documentclass[10pt,aspectratio=169]{beamer} % aspect ratio 16:9, only frames
%\documentclass[10pt,aspectratio=169,notes]{beamer} % aspect ratio 16:9, frames+notes 
%\documentclass[10pt,aspectratio=169,notes=only]{beamer} % aspect ratio 16:9, notes only 
\usepackage{pgfpages}
%\setbeameroption{show notes}
%\setbeameroption{show notes on second screen=right}
%\setbeameroption{show notes on second screen=bottom} % does not work for animations

%\graphicspath{{../../figures/}}
\graphicspath{{figs/}}
%\includeonlyframes{frame1,frame2,frame3}
%\includeonlyframes{frame6}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Packages
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{appendixnumberbeamer}
\usepackage{booktabs}
\usepackage{csvsimple} % for csv read
\usepackage[scale=2]{ccicons}
\usepackage{pgfplots}
\usepackage{xspace}
\usepackage{amsmath}
\usepackage{totcount}
\usepackage{tikz}
\usepackage{bm}
%\usepackage{FiraSans}
\usepackage{mathrsfs} % for Fourier and Laplace symbols
\usepackage{verbatim}
%\usepackage{eulervm} % alternative math fonts
%\usepackage{comment}
\usetikzlibrary{external} % speedup compilation
%\tikzexternalize % activate!
%\usetikzlibrary{shapes,arrows}  
% the animations are only supported by some pdf readers (AcrobatReader, PDF-XChange, acroread, and Foxit Reader)
\usepackage{animate}
\usepackage{ifthen}
\newcounter{angle}
\setcounter{angle}{0}
%\usepackage{bibentry}
%\nobibliography*
\usepackage{caption}%
\captionsetup[figure]{labelformat=empty}%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Metropolis theme custom modification file
\input{metropolis_mods.tex}
%\usefonttheme[onlymath]{Serif} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Custom commands
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% matrix command 
%\newcommand{\matr}[1]{\mathbf{#1}} % bold upright (Elsevier, Springer)
%  metropolis compatible (FiraSans auto replacement)
\newcommand{\matr}[1]{\boldsymbol{#1}}
%\newcommand{\matr}[1]{#1}          % pure math version
%\newcommand{\matr}[1]{\bm{#1}}     % ISO complying version
% vector command 
%\newcommand{\vect}[1]{\mathbf{#1}} % bold upright (Elsevier, Springer)
% metropolis compatible (FiraSans auto replacement)
\newcommand{\vect}[1]{\boldsymbol{#1}}
% bold symbol
\newcommand{\bs}[1]{\boldsymbol{#1}}
% derivative upright command
\DeclareRobustCommand*{\drv}{\mathop{}\!\mathrm{d}}
\newcommand{\ud}{\mathrm{d}}
\newcommand{\myexp}{\mathrm{e}}
% 
\newcommand{\themename}{\textbf{\textsc{metropolis}}\xspace}
\renewcommand{\Re}{\operatorname{\mathbb{R}e}}
\renewcommand{\Im}{\operatorname{\mathbb{I}m}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  Title page options
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \date{\today}
\date{}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% option 1
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\title{Application of Fourier transform in selected problems of mechanics, signal processing and imaging}
\subtitle{Lecture Series}
\author{\textbf{Pawe≈Ç Kudela} }
% logo align to Institute 
\institute{Institute of Fluid Flow Machinery\\Polish Academy of Sciences \\ \vspace{-1.5cm}\flushright \includegraphics[width=4cm]{//odroid-sensors/sensors/MISD_shared/logo/logo_eng_40mm.eps}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\tikzexternalize % activate!
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\maketitle
%%%%%%%%%%%%%%%%%%%%
\note{My name is Pawel Kudela. 
I am an associate professor at the Institute of Fluid Machinery, Polish Academy of Sciences.
I will give you a few lectures in the frame of the doctoral school.
Today's topic is a Fourier transform.
You can look at the Fourier transform from various perspectives such as mathematical formula or numerical algorithm.
But my intention is to give you some intuition about the mathematics behind the Fourier transform and look at it from engineer perspective so you can confidently use it as a tool in your particular problem.
I will be using Matlab to illustrate examples of practical applications of the Fourier transform.}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SLIDES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[label=frame1]{Table of contents}
  \setbeamertemplate{section in toc}[sections numbered]
  \tableofcontents[hideallsubsections]
\end{frame}
%%%%%%%%%%%%%%%%%%%%
\note{I will start with the \textbf{Fourier series}, then mathematical formulation of the \textbf{Continuous Fourier Transform}.
Next, I will move to the \textbf{Discrete Fourier Transform}.
I will cover also inverse Fourier Transform. 
Then, I will explain how to apply Fourier transforms to selected problem of mechanics which will be \textbf{Heat transfer problem}. 
Finally I will show you a few examples of \textbf{Signal filtering} and \textbf{Image filtering}.
At the end you will be given an \textbf{Assignment} so I encourage you to listen carefully.}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Fourier Series}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[label=frame2]{Jean-Baptiste Joseph Fourier}
\begin{columns}[T]
  \column{0.5\textwidth}
		Jean-Baptiste Joseph \alert{Fourier} 1768--1830
		 \begin{itemize}
			\item Mathematician
			\item Physicist
			\item \emph{The Analytic Theory of Heat}
			\item Fourier series
			\item Fourier transform
		\end{itemize}
  \column{0.5\textwidth}
  	\begin{figure}
  		\includegraphics[width=0.7\textwidth]{Fourier2.jpg}
  	\end{figure}
\end{columns}
\end{frame}
%%%%%%%%%%%%%%%%%%%%
\note{Jean-Baptiste Joseph Fourier was a French mathematician and physicist best known for initiating the investigation of Fourier series.
Fourier, the son of a tailor, first attended the local military school conducted by Benedictine monks. 
It is said that he saved wax from the candle ends so that he could study at night.
He showed such proficiency in mathematics in his early years that he later became a teacher in mathematics at the same school. 	
As a student, he received lessons from eminent teachers like Lagrange, Laplace and Monge.
After passing out from school, he entered the Benedictine abbey with the intention of becoming a priest. 
However, he slowly became involved in politics; joined the local Revolutionary Committee.
He was imprisoned briefly during the French Revolution.	
In 1798 Fourier accompanied Napoleon on his expedition to Egypt. 
He was engaged in extensive research on Egyptian antiquities, gave advice on engineering and diplomatic undertakings.
On his return, Napoleon appointed him Prefect (Governor) of the Department of Is\`{e}re in Grenoble. 
He showed great administrative ability while continuing his Egyptological and mathematical work.
At that time, he began to experiment on the propagation of heat.
And here our story begins.
 }
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[fragile]{Fourier's idea}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{equation*}
\frac{4}{\pi}\left( \frac{\cos \pi x}{1} - \frac{\cos (3 \pi x) }{3} + \frac{\cos (5 \pi x)}{5} - \frac{\cos (7 \pi x)}{7} +  \ldots \right) = \left\{ \begin{array}{rll} 1& \mathrm{if} & x<0.5\\ 0 & \mathrm{if}& x=0.5\\ -1& \mathrm{if} & x>0.5 \end{array} \right.
\end{equation*}
\begin{columns}[T]
	\column{0.5\textwidth}
	\centering
		% 3 frames per second
		%\animategraphics[controls,loop,autoplay]{3}{Fourier_series_}{1}{25}
		\animategraphics[loop,autoplay]{3}{Fourier_series_}{1}{25}
		%	\animategraphics[controls,loop,autoplay,width=\linewidth]{3}{Fourier_series_}{1}{25}
	\column{0.5\textwidth}
	\centering
			\includegraphics{step_function}
	\end{columns}
%%%%%%%%%%%%%%%%%%%%
\end{frame}
\note{Fourier was obsessed with the physics of heat and developed the Fourier series and transform to model heat-flow problems.
He had an idea that any periodic function can be rewritten as a weighted sum of sines and cosines of different frequencies.
The resulting wave is periodic, but not harmonic.


}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[fragile]{Heat flow}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\begin{equation*}
T(x,t)=	\frac{4}{\pi}\left( \frac{\cos \pi x}{1} \, \myexp^{-\alpha 1^2 t} - \frac{\cos (3 \pi x) }{3} \, \myexp^{-\alpha 3^2 t} + \frac{\cos (5 \pi x)}{5} \, \myexp^{-\alpha 5^2 t}  -   \ldots \right)
	\end{equation*}
	\begin{columns}[T]
		\column{0.5\textwidth}
		\centering
		% 2 frames per second
		\animategraphics[controls,loop]{2}{Fourier_series_rod_temperatures_}{1}{27}
		\column{0.5\textwidth}
		\centering
		
	\end{columns}
	%%%%%%%%%%%%%%%%%%%%
\end{frame}
\note{In engineering applications, the Fourier series is generally presumed to converge everywhere except at discontinuities.
	
	
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Fourier series definition}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Fourier series can be written in a general form:
\begin{equation*}
s_N(x)=	\frac{a_0}{2} + \underbrace{ \sum \limits_{n=1}^N a_n \cos \left(\frac{2 \pi n x}{P} \right)}_{\mathrm{even \, component}} +  \underbrace{\sum \limits_{n=1}^N b_n \sin \left( \frac{2 \pi n x}{P} \right)}_{\mathrm{odd \, component}}
\end{equation*}
where \(P\) is the interval length (period of the Fourier series) and \(N\) is theoretically \(\infty\).\\
Fourier coefficients are:
	\begin{equation*}
	a_n= \frac{2}{P}	\int_P s(x)\, \cos \left(2 \pi x \frac{n}{P}\right) \ud x \quad 	b_n= \frac{2}{P}	\int_P s(x)\, \sin\left(2 \pi x \frac{n}{P}\right) \ud x 
	\end{equation*}
	
%%%%%%%%%%%%%%%%%%%%
\end{frame}
\note{
	
	
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Continuous Fourier Transform}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[fragile,label=frame3]{Continuous Fourier Transform - definition}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\begin{equation*}
	F(\omega) = \int \limits_{-\infty}^{\infty} f(t)\, \myexp^{-i \omega t} \ud t 
	\end{equation*}
	where \(i=\sqrt{-1}\) denotes imaginary component\\
Other notations
	\begin{equation*}
	\hat{g}(\omega) = \int \limits_{-\infty}^{\infty} g(t)\, \myexp^{-i \omega t} \ud t 
	\end{equation*}
	\begin{equation*}
	\mathscr{F}\{E(t)\}= 	\left(\mathscr{F} E \right)(\omega)=\mathcal{F} \left[E(t) \right](\omega) =\tilde{E}(\omega) =  \int \limits_{-\infty}^{\infty} E(t)\, \myexp^{-i \omega t} \ud t 
	\end{equation*}
The Fourier transform can be denoted by:\\
 \(\mathcal{F}\) which can be produced in LaTeX by: \verb+\mathcal{F}+\\
\(\mathscr{F}\) which can be produced in LaTeX by: \verb+\mathscr{F}+\\

\end{frame}
%%%%%%%%%%%%%%%%%%%%
\note{\(F\) with the argument \(\omega\) is called the Fourier transform of function \(f\) with the argument \(t\).
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[label=frame4]{Forward and inverse Fourier transform}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{columns}[T]
	\column{0.5\textwidth}	
	\centering
	Forward\\
	\begin{equation*}
	\hat{g}(\omega) = \int \limits_{-\infty}^{\infty} g(t)\, \myexp^{-i \omega t} \ud t 
	\end{equation*}
	\begin{equation*}
	\mathcal{F} \left[f(t) \right](\omega)=\int \limits_{-\infty}^{\infty} f(t)\, \myexp^{-i \omega t} \ud t 
	\end{equation*}
	\begin{equation*}
	f(t) \rightarrow \mathcal{F} \left[f(t) \right] \quad  \textrm{or:} \quad f(t)  \rightarrow F(\omega)
	\end{equation*}
	Mapping between the time domain \(t\) \\and the frequency domain \(\omega\)
	\column{0.5\textwidth}
	\centering
	Inverse\\
	\begin{equation*}
	g(t) = \frac{1}{2 \pi} \int \limits_{-\infty}^{\infty} \hat{g}(\omega)\, \myexp^{i \omega t} \ud t 
	\end{equation*}
    \begin{equation*}	
    \mathcal{F}^{-1} \left[F(\omega) \right](t)=\frac{1}{2 \pi}  \int \limits_{-\infty}^{\infty} F(\omega)\, \myexp^{i \omega t} \ud t 
	\end{equation*}
	\begin{equation*}
	F(\omega) \rightarrow \mathcal{F}^{-1} \left[F(\omega) \right] \quad   \textrm{or:} \quad 	F(\omega) \rightarrow f(t)
	\end{equation*}
	Mapping between the frequency domain  \(\omega\) \\and the time domain \(t\)
	
\end{columns}
\end{frame}
%%%%%%%%%%%%%%%%%%%%
\note{Fourier transform is an equation. 
It is a result of a transformation or mapping between one domain and other domain.
Forward Fourier transform is a mapping between the time domain \(t\) and the frequency domain \(\omega\).
Inverse Fourier transfor is a mapping  between the frequency domain  \(\omega\) and the time domain \(t\).}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[fragile,label=frame5]{Intuition behind Fourier transform}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{columns}[T]
	\begin{column}{0.5\textwidth}
	\begin{animateinline}[loop, poster = 45, controls]{30}
		%
		\whiledo{\theangle<359}{
			%
			\begin{tikzpicture}
			% Axis
			\draw[thick,->,logoblue] (-3,0)--(3,0) node[below] {$\Re$}; % x axis
			\draw[thick,->,logoblue] (0,-3)--(0,3) node[left] {$\Im$}; % y axis
			\draw[logoblue,thick] (0,0) circle (2.5cm);
			\node[logoblue,below] at (2.6,0) {1};
			\node[logoblue,above] at (0.12,2.5) {1};
			%
			%\draw[ultra thick,cyan] (0,0) -- (0,0 |- \theangle:2.5cm); % UpOn x axis
			\draw[ultra thick,orange] (0,0) -- (\theangle:2.5cm |- 0,0); % UpOn y axis
			%
			\draw[ultra thick,cyan] (\theangle:2.5cm) -- (\theangle:2.5cm |- 0,0); % vertical line
			\draw[densely dotted,cyan] (\theangle:2.5cm) -- (0,0 |- \theangle:2.5cm); % horizontal line
			\draw[ultra thick,red,->,rotate=\theangle] (0,0) -- (2.5,0); 
			\draw[->,semithick,green] (0:0.9cm) arc[radius=0.9, start angle=0, end angle=\theangle]; % phase angle
			\node[green,right] at (0.2,0.2) {$\phi$}; % psi symbol
			\node[red,orange,right] at (0,-3.5) 
			{%\footnotesize$\cos(\theangle^{\mathrm{o}}) = \pgfmathcos{\theangle}\pgfmathresult$
			};
			\node[red,cyan,right] at (0,-3.1) 
			{%\footnotesize$\sin(\theangle^{\mathrm{o}}) = \pgfmathsin{\theangle}\pgfmathresult$
			};
			\end{tikzpicture}
			%
			\stepcounter{angle}
			\ifthenelse{\theangle<359}{
				\newframe
			}{
			\end{animateinline}
		}
	}
\end{column}
	\begin{column}{0.5\textwidth}
	\begin{equation*}
	F(\omega) = \int \limits_{-\infty}^{\infty} f(t)\, \myexp^{-i \omega t} \ud t 
	\end{equation*}
	Euler's formula \(\myexp^{-i \omega t} = \cos (\omega t) - i \sin(\omega t)\)
	\begin{equation*}
	F(\omega) = \int \limits_{-\infty}^{\infty} f(t) \left[\cos (\omega t) - i \sin(\omega t) \right] \ud t 
	\end{equation*}
	\begin{equation*}
	F(\omega) = \color{orange} \int \limits_{-\infty}^{\infty} f(t) \cos (\omega t)  \ud t \, - \, \color{cyan}  i   \int \limits_{-\infty}^{\infty}  f(t) \sin(\omega t)  \ud t 
	\end{equation*}
	\begin{equation*}
		\color{red} A = \pm \sqrt{\Re^2 + \Im^2}
	\end{equation*}
	\begin{equation*}
	\color{green}  \phi = \tan^{-1} \frac{\Im}{\Re}
	\end{equation*}
	\end{column}
\end{columns}
\end{frame}
%%%%%%%%%%%%%%%%%%%%
\note{}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[fragile]{Fourier series vs Fourier transform}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Fourier coefficients are:
\begin{equation*}
a_n= \frac{2}{P}	\int_P s(t)\, \cos \left(2 \pi t \frac{\textcolor{red}{n}}{P}\right) \ud t \quad 	b_n= \frac{2}{P}	\int_P s(t)\, \sin\left(2 \pi t \frac{\textcolor{red}{n}}{P}\right) \ud t 
\end{equation*}
Fourier forward transform:
\begin{equation*}
S(\omega) =  \int \limits_{-\infty}^{\infty} s(t) \cos (\omega t)  \ud t \, - \,  i   \int \limits_{-\infty}^{\infty}  s(t) \sin(\omega t)  \ud t 
\end{equation*}
\(\omega = 2 \pi f\)
\begin{equation*}
S(\omega) =  \int \limits_{-\infty}^{\infty} s(t) \cos (2 \pi t \textcolor{red}{f})  \ud t \, - \,  i   \int \limits_{-\infty}^{\infty}  s(t) \sin(2 \pi t \textcolor{red}{f})  \ud t 
\end{equation*}
\(P\rightarrow \infty\) \url{https://dspillustrations.com/pages/posts/misc/the-complex-fourier-series-and-its-relation-to-the-fourier-transform.html}
\end{frame}
%%%%%%%%%%%%%%%%%%%%
\note{
	The Fourier series is used to represent a periodic function by a discrete sum of complex exponentials, while the Fourier transform is then used to represent a general, nonperiodic function by a continuous superposition or integral of complex exponentials. The Fourier transform can be viewed as the limit of the Fourier series of a function with the period approaches to infinity, so the limits of integration change from one period to \((-\infty, \infty)\).
	
	Fourier transform is used to transform periodic and non-periodic signals from time domain to frequency domain. It can also transform Fourier series into the frequency domain, as Fourier series is nothing but a simplified form of time domain periodic function.
	
	Fourier series
	Periodic function => converts into a discrete exponential or sine and cosine function.
	
	Non-periodic function => not applicable
	
	Fourier transform
	Periodic function => converts its Fourier series in the frequency domain.
	
	non-Periodic function => converts it into continuous frequency domain.
A periodic function is a function that repeats its values in regular intervals or periods. 
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Discrete Fourier Transform}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Aliasing}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{alertblock}{Aliasing}
	Aliasing is
\end{alertblock}
\end{frame}
\note{Aliasing}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Heat transfer problem}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Signal filtering}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Image filtering}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Assignment}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
{\setbeamercolor{palette primary}{fg=black, bg=white}
\begin{frame}[standout]
  Thank you for your attention!\\ \vspace{12pt}
  Questions?\\ \vspace{12pt}
  \url{pk@imp.gda.pl}
\end{frame}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% END OF SLIDES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}