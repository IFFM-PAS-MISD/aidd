%\documentclass[10pt]{beamer} % aspect ratio 4:3, 128 mm by 96 mm
\documentclass[10pt,aspectratio=169]{beamer} % aspect ratio 16:9, only frames
%\documentclass[10pt,aspectratio=169,notes]{beamer} % aspect ratio 16:9, frames+notes 
%\documentclass[10pt,aspectratio=169,notes=only]{beamer} % aspect ratio 16:9, notes only 
\usepackage{pgfpages}
\setbeameroption{show notes}
%\setbeameroption{show notes on second screen=right}
%\setbeameroption{show notes on second screen=bottom} % does not work for animations

%\graphicspath{{../../figures/}}
\graphicspath{{figs/}}
%\includeonlyframes{frame1,frame2,frame3}
%\includeonlyframes{frame6}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Packages
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{appendixnumberbeamer}
\usepackage{booktabs}
\usepackage{csvsimple} % for csv read
\usepackage[scale=2]{ccicons}
\usepackage{pgfplots}
\usepackage{xspace}
\usepackage{amsmath}
\usepackage{totcount}
\usepackage{tikz}
\usepackage{bm}
%\usepackage{FiraSans}
\usepackage{mathrsfs} % for Fourier and Laplace symbols
\usepackage{verbatim}
%\usepackage{eulervm} % alternative math fonts
%\usepackage{comment}
\usetikzlibrary{external} % speedup compilation
%\tikzexternalize % activate!
%\usetikzlibrary{shapes,arrows}  
% the animations are only supported by some pdf readers (AcrobatReader, PDF-XChange, acroread, and Foxit Reader)
\usepackage{animate}
\usepackage{ifthen}
\newcounter{angle}
\setcounter{angle}{0}
%\usepackage{bibentry}
%\nobibliography*
\usepackage{caption}%
\captionsetup[figure]{labelformat=empty}%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Metropolis theme custom modification file
\input{metropolis_mods.tex}
%\usefonttheme[onlymath]{Serif} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Custom commands
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% matrix command 
%\newcommand{\matr}[1]{\mathbf{#1}} % bold upright (Elsevier, Springer)
%  metropolis compatible (FiraSans auto replacement)
\newcommand{\matr}[1]{\boldsymbol{#1}}
%\newcommand{\matr}[1]{#1}          % pure math version
%\newcommand{\matr}[1]{\bm{#1}}     % ISO complying version
% vector command 
%\newcommand{\vect}[1]{\mathbf{#1}} % bold upright (Elsevier, Springer)
% metropolis compatible (FiraSans auto replacement)
\newcommand{\vect}[1]{\boldsymbol{#1}}
% bold symbol
\newcommand{\bs}[1]{\boldsymbol{#1}}
% derivative upright command
\DeclareRobustCommand*{\drv}{\mathop{}\!\mathrm{d}}
\newcommand{\ud}{\mathrm{d}}
\newcommand{\myexp}{\mathrm{e}}
% 
\newcommand{\themename}{\textbf{\textsc{metropolis}}\xspace}
\renewcommand{\Re}{\operatorname{\mathbb{R}e}}
\renewcommand{\Im}{\operatorname{\mathbb{I}m}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  Title page options
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \date{\today}
\date{}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% option 1
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\title{Application of Fourier transform in selected problems of mechanics, signal processing and imaging}
\subtitle{Lecture Series}
\author{\textbf{Paweł Kudela} }
% logo align to Institute 
\institute{Institute of Fluid Flow Machinery\\Polish Academy of Sciences \\ \vspace{-1.5cm}\flushright \includegraphics[width=4cm]{//odroid-sensors/sensors/MISD_shared/logo/logo_eng_40mm.eps}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\tikzexternalize % activate!
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\maketitle
%%%%%%%%%%%%%%%%%%%%
\note{My name is Pawel Kudela. 
I am an associate professor at the Institute of Fluid Machinery, Polish Academy of Sciences.
I will give you a few lectures in the frame of the doctoral school.
Today's topic is a Fourier transform.
You can look at the Fourier transform from various perspectives such as mathematical formula or numerical algorithm.
But my intention is to give you some intuition about the mathematics behind the Fourier transform and look at it from engineer perspective so you can confidently use it as a tool in your particular problem.
I will be using Matlab to illustrate examples of practical applications of the Fourier transform.}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SLIDES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[label=frame1]{Table of contents}
  \setbeamertemplate{section in toc}[sections numbered]
  \tableofcontents[hideallsubsections]
\end{frame}
%%%%%%%%%%%%%%%%%%%%
\note{I will start with the \textbf{Fourier series}, then mathematical formulation of the \textbf{Continuous Fourier Transform}.
Next, I will move to the \textbf{Discrete Fourier Transform}.
I will cover also inverse Fourier Transform. 
Then, I will explain how to apply Fourier transforms to selected problem of mechanics which will be \textbf{Heat transfer problem}. 
Finally I will show you a few examples of \textbf{Signal filtering} and \textbf{Image filtering}.
At the end you will be given an \textbf{Assignment} so I encourage you to listen carefully.}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Fourier Series}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[label=frame2]{Jean-Baptiste Joseph Fourier}
\begin{columns}[T]
  \column{0.5\textwidth}
		Jean-Baptiste Joseph \alert{Fourier} 1768--1830
		 \begin{itemize}
			\item Mathematician
			\item Physicist
			\item \emph{The Analytic Theory of Heat}
			\item Fourier series
			\item Fourier transform
		\end{itemize}
  \column{0.5\textwidth}
  	\begin{figure}
  		\includegraphics[width=0.7\textwidth]{Fourier2.jpg}
  	\end{figure}
\end{columns}
\end{frame}
%%%%%%%%%%%%%%%%%%%%
\note{Jean-Baptiste Joseph Fourier was a French mathematician and physicist best known for initiating the investigation of Fourier series.
Fourier, the son of a tailor, first attended the local military school conducted by Benedictine monks. 
It is said that he saved wax from the candle ends so that he could study at night.
He showed such proficiency in mathematics in his early years that he later became a teacher in mathematics at the same school. 	
As a student, he received lessons from eminent teachers like Lagrange, Laplace and Monge.
After passing out from school, he entered the Benedictine abbey with the intention of becoming a priest. 
However, he slowly became involved in politics; joined the local Revolutionary Committee.
He was imprisoned briefly during the French Revolution.	
In 1798 Fourier accompanied Napoleon on his expedition to Egypt. 
He was engaged in extensive research on Egyptian antiquities, gave advice on engineering and diplomatic undertakings.
On his return, Napoleon appointed him Prefect (Governor) of the Department of Is\`{e}re in Grenoble. 
He showed great administrative ability while continuing his Egyptological and mathematical work.
At that time, he began to experiment on the propagation of heat.
And here our story begins.
 }
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[fragile]{Fourier's idea}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{equation*}
\frac{4}{\pi}\left( \frac{\cos \pi x}{1} - \frac{\cos (3 \pi x) }{3} + \frac{\cos (5 \pi x)}{5} - \frac{\cos (7 \pi x)}{7} +  \ldots \right) = \left\{ \begin{array}{rll} 1& \mathrm{if} & x<0.5\\ 0 & \mathrm{if}& x=0.5\\ -1& \mathrm{if} & x>0.5 \end{array} \right.
\end{equation*}
\begin{columns}[T]
	\column{0.5\textwidth}
	\centering
		% 3 frames per second
		%\animategraphics[controls,loop,autoplay]{3}{Fourier_series_}{1}{25}
		\animategraphics[loop,autoplay]{3}{Fourier_series_}{1}{25}
		%	\animategraphics[controls,loop,autoplay,width=\linewidth]{3}{Fourier_series_}{1}{25}
	\column{0.5\textwidth}
	\centering
			\includegraphics{step_function}
	\end{columns}
\end{frame}
%%%%%%%%%%%%%%%%%%%%
\note{Fourier was obsessed with the physics of heat and developed the Fourier series and transform to model heat-flow problems.
He had an idea that any periodic function can be rewritten as a weighted sum of sines and cosines of different frequencies.
On the right hand side is a step function.
The step function can be approximated by Fourier series. 
However, we are restricted by boundary conditions.
In this case only cosine components are necessary.
For other boundary conditions, we may need to use sine components as well.
The more the Fourier series elements we take, the more accurate representation of the step function is achieved.
Therefore, the equation above holds true if the infinite sum is applied.
It should be noted that we had to add a point at discontinuity in the middle of the step function jump.
In summary, the infinite sum of wavy continous functions can equal a discontinous flat function like this.
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[fragile]{Heat flow}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\begin{equation*}
T(x,t)=	\frac{4}{\pi}\left( \frac{\cos \pi x}{1} \, \myexp^{-\alpha 1^2 t} - \frac{\cos (3 \pi x) }{3} \, \myexp^{-\alpha 3^2 t} + \frac{\cos (5 \pi x)}{5} \, \myexp^{-\alpha 5^2 t}  -   \ldots \right)
	\end{equation*}
	\begin{columns}[T]
		\column{0.5\textwidth}
		\centering
		% 2 frames per second
		\animategraphics[controls,loop]{2}{Fourier_series_rod_temperatures_}{1}{27}
		\column{0.5\textwidth}
		Fourier series converges to the exact solution when the number of added terms goes to \(\infty\) and if the function satisfies so-called Dirichlet boundary conditions (values that a solution needs to take along the boundary of the domain).
	\end{columns}
\end{frame}
%%%%%%%%%%%%%%%%%%%%
\note{Let's assume that you brought two rods with uniform temperatures and you want to know what happens immediately after they come into contact.
To make the numbers simple let's assume that the temperature of left rod is 1 degree and the right rod is negative 1 degree and the total length of combine rods is 1.
It means that our initial temperature distribution is the step function.
So, when we take the heat equation solution associated with these cosine waves and add infinitely many of them we do get exact solution describing how the step function will evolve over time.
Here, I have taken 250 sums in Fourier series.
It can be noted that in engineering applications, the Fourier series is generally presumed to converge everywhere except at discontinuities.
The key challenge is to find coefficients which stays besides sine and cosine terms.	
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Fourier series definition}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Fourier series can be written in a general form:
\begin{equation*}
s_N(x)=	\frac{a_0}{2} + \underbrace{ \sum \limits_{n=1}^N a_n \cos \left(\frac{2 \pi n x}{P} \right)}_{\mathrm{even \, component}} +  \underbrace{\sum \limits_{n=1}^N b_n \sin \left( \frac{2 \pi n x}{P} \right)}_{\mathrm{odd \, component}}
\end{equation*}
where \(P\) is the interval length (period of the Fourier series) and \(N\) is theoretically \(\infty\).\\
Fourier coefficients are:
	\begin{equation*}
		a_0= \frac{1}{P}	\int_P s(x) \ud x \quad  a_n= \frac{2}{P}	\int_P s(x)\, \cos \left(2 \pi x \frac{n}{P}\right) \ud x \quad 	b_n= \frac{2}{P}	\int_P s(x)\, \sin\left(2 \pi x \frac{n}{P}\right) \ud x 
	\end{equation*}
\end{frame}	
%%%%%%%%%%%%%%%%%%%%
\note{The formal definition of Fourier series expansion is a sum of infinite number of even and odd components. 
Even components are cosine terms multiplied by \(a_n\) and odd components are sine terms multiplied by \(b_n\).
There is also additional \(a_0\) coefficient in front.
P is the interval length (period of the Fourier series).
\(a_0\) , \(a_n\) and \(b_n\) are Fourier coefficients which can be calculated by using these formulas.
The derivation of Fourier coefficients can be found in any textbooks so I will skip it here.	
But as you can see, it is quite easy to find Fourier coefficients of the function \(s(x)\) and approximate this fuction by Fourier series.	
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Continuous Fourier Transform}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[fragile,label=frame3]{Continuous Fourier Transform - definition}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\begin{equation*}
	F(\omega) = \int \limits_{-\infty}^{\infty} f(t)\, \myexp^{-i \omega t} \ud t 
	\end{equation*}
	where \(i=\sqrt{-1}\) denotes imaginary component\\
Other notations
	\begin{equation*}
	\hat{f}(\omega) = \int \limits_{-\infty}^{\infty} f(t)\, \myexp^{-i \omega t} \ud t 
	\end{equation*}
	\begin{equation*}
	\mathscr{F}\{E(t)\}= 	\left(\mathscr{F} E \right)(\omega)=\mathcal{F} \left[E(t) \right](\omega) =\tilde{E}(\omega) =  \int \limits_{-\infty}^{\infty} E(t)\, \myexp^{-i \omega t} \ud t 
	\end{equation*}
The Fourier transform can be denoted by:\\
 \(\mathcal{F}\) which can be produced in LaTeX by: \verb+\mathcal{F}+\\
\(\mathscr{F}\) which can be produced in LaTeX by: \verb+\mathscr{F}+\\

\end{frame}
%%%%%%%%%%%%%%%%%%%%
\note{\(F\) with the argument \(\omega\) is called the Fourier transform of function \(f\) with the argument \(t\).
\(i\) is the square root of negative one which denotes imaginary components.
In this definition function under integral is denoted by lower case letter wheres the transform is denoted by upper case letter.
You can also find  in the literature other notations.
For example if you want to use the same lower case letter, for distinction of the transform, hat over the letter is placed.
In case of capital letter under integral, Fourier transform can be denoted by fancy symbol F.
It can be produced in LaTeX like this. 
It is an operator applied to function \(E(t)\); also the resulting domain \(\omega\) can be specified.
Eventually, tilde over upper case letter can be used.
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[label=frame4]{Forward and inverse Fourier transform}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{columns}[T]
	\column{0.5\textwidth}	
	\centering
	Forward\\
	\begin{equation*}
	\hat{g}(\omega) = \int \limits_{-\infty}^{\infty} g(t)\, \myexp^{-i \omega t} \ud t 
	\end{equation*}
	\begin{equation*}
	\mathcal{F} \left[f(t) \right](\omega)=\int \limits_{-\infty}^{\infty} f(t)\, \myexp^{-i \omega t} \ud t 
	\end{equation*}
	\begin{equation*}
	f(t) \rightarrow \mathcal{F} \left[f(t) \right] \quad  \textrm{or:} \quad f(t)  \rightarrow F(\omega)
	\end{equation*}
	Mapping between the time domain \(t\) \\and the frequency domain \(\omega\)
	\column{0.5\textwidth}
	\centering
	Inverse\\
	\begin{equation*}
	f(t) = \frac{1}{2 \pi} \int \limits_{-\infty}^{\infty} \hat{f}(\omega)\, \myexp^{i \omega t} \ud t 
	\end{equation*}
    \begin{equation*}	
    \mathcal{F}^{-1} \left[F(\omega) \right](t)=\frac{1}{2 \pi}  \int \limits_{-\infty}^{\infty} F(\omega)\, \myexp^{i \omega t} \ud t 
	\end{equation*}
	\begin{equation*}
	F(\omega) \rightarrow \mathcal{F}^{-1} \left[F(\omega) \right] \quad   \textrm{or:} \quad 	F(\omega) \rightarrow f(t)
	\end{equation*}
	Mapping between the frequency domain  \(\omega\) \\and the time domain \(t\)
	
\end{columns}
\end{frame}
%%%%%%%%%%%%%%%%%%%%
\note{Fourier transform is an equation. 
It is a result of a transformation or mapping between one domain and another domain.
In the presented example, the Forward Fourier transform is a mapping between the time domain \(t\) and the frequency domain \(\omega\).
The Inverse Fourier transform is a mapping  between the frequency domain  \(\omega\) and the time domain \(t\).
All of these notations can be used interchangeably.
If you look carefully at this equations you will see some differences.
In the forward Forward Fourier transform the exponent term is negative, whereas in the Inverse Fourier transform the exponent term is positive.
Furthermore, in the inverse Fourier transform we have additional scaling factor: one over two pi.
It is important to note that in both cases the integral interval is \((-\infty, \infty)\).
It should be also added that \(f\) and \(\hat{f}\) are in general complex functions.
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[fragile,label=frame5]{Intuition behind Fourier transform}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{columns}[T]
	\begin{column}{0.5\textwidth}
	\begin{animateinline}[loop, poster = 45, controls]{30}
		%
		\whiledo{\theangle<359}{
			%
			\begin{tikzpicture}
			% Axis
			\draw[thick,->,logoblue] (-3,0)--(3,0) node[below] {$\Re$}; % x axis
			\draw[thick,->,logoblue] (0,-3)--(0,3) node[left] {$\Im$}; % y axis
			\draw[logoblue,thick] (0,0) circle (2.5cm);
			\node[logoblue,below] at (2.6,0) {1};
			\node[logoblue,above] at (0.12,2.5) {1};
			%
			%\draw[ultra thick,cyan] (0,0) -- (0,0 |- \theangle:2.5cm); % UpOn x axis
			\draw[ultra thick,orange] (0,0) -- (\theangle:2.5cm |- 0,0); % UpOn y axis
			%
			\draw[ultra thick,cyan] (\theangle:2.5cm) -- (\theangle:2.5cm |- 0,0); % vertical line
			\draw[densely dotted,cyan] (\theangle:2.5cm) -- (0,0 |- \theangle:2.5cm); % horizontal line
			\draw[ultra thick,red,->,rotate=\theangle] (0,0) -- (2.5,0); 
			\draw[->,semithick,green] (0:0.9cm) arc[radius=0.9, start angle=0, end angle=\theangle]; % phase angle
			\node[green,right] at (0.2,0.2) {$\phi$}; % psi symbol
			\node[red,orange,right] at (0,-3.5) 
			{%\footnotesize$\cos(\theangle^{\mathrm{o}}) = \pgfmathcos{\theangle}\pgfmathresult$
			};
			\node[red,cyan,right] at (0,-3.1) 
			{%\footnotesize$\sin(\theangle^{\mathrm{o}}) = \pgfmathsin{\theangle}\pgfmathresult$
			};
			\end{tikzpicture}
			%
			\stepcounter{angle}
			\ifthenelse{\theangle<359}{
				\newframe
			}{
			\end{animateinline}
		}
	}
\end{column}
	\begin{column}{0.5\textwidth}
	\begin{equation*}
	F(\omega) = \int \limits_{-\infty}^{\infty} f(t)\, \myexp^{-i \omega t} \ud t 
	\end{equation*}
	Euler's formula \(\myexp^{-i \omega t} = \cos (\omega t) - i \sin(\omega t)\)
	\begin{equation*}
	F(\omega) = \int \limits_{-\infty}^{\infty} f(t) \left[\cos (\omega t) - i \sin(\omega t) \right] \ud t 
	\end{equation*}
	\begin{equation*}
	F(\omega) = \color{orange} \int \limits_{-\infty}^{\infty} f(t) \cos (\omega t)  \ud t \, - \, \color{cyan}  i   \int \limits_{-\infty}^{\infty}  f(t) \sin(\omega t)  \ud t 
	\end{equation*}
	\begin{equation*}
		\color{red} A = \sqrt{\Re^2 + \Im^2}
		\label{eq:Fourier_magnitude}
	\end{equation*}
	\begin{equation*}
	\color{green}  \phi = \tan^{-1} \frac{\Im}{\Re}
	\label{eq:Fourier_phase}
	\end{equation*}
	\end{column}
\end{columns}
\end{frame}
%%%%%%%%%%%%%%%%%%%%
\note{In order to have better intuition of the Fourier transform, let's substitute Euler's formula to the Fourier transform definition.
Now, we can split integral into two parts: real and imaginary.
Under integral we have a function \(f(t)\) which we want to transform which is multiplied by some analysing function. 
The analysing function is cosine in case of real part and sine in case of imaginary part.
The interpretation of the integral over function is the area. 
Therefore, we can calculate area of the real part and imaginary part separately and place them on complex plain.
The magnitude of the Fourier transform, denoted in the figure by red arrow, can be calculated by using the formula given in red colour.
The phase of the Fourier transform fi \(\phi\) is an angle denoted in the figure by a green arrow and can be calculated by using the formula given in green colour.
Of course, real part and imaginary part can also be negative.
Therefore, the magnitude arrow can be on any qurter of complex plane as it is shown on the animation.
Hence, to identify appropriate quarter, the information about phase can be used.
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[fragile]{Fourier series vs Fourier transform (1)}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Fourier coefficients are:
\begin{equation*}
a_n= \frac{2}{P}	\int_{\textcolor{green}{P}} s(t)\, \cos \left(2 \pi t \frac{\textcolor{red}{n}}{\textcolor{red}{P}}\right) \ud t \quad 	b_n= \frac{2}{P}	\int_{\textcolor{green}{P}} s(t)\, \sin\left(2 \pi t \frac{\textcolor{red}{n}}{\textcolor{red}{P}}\right) \ud t 
\end{equation*}
Forward Fourier transform:
\begin{equation*}
S(\omega) =  \int \limits_{-\infty}^{\infty} s(t) \cos (\omega t)  \ud t \, - \,  i   \int \limits_{-\infty}^{\infty}  s(t) \sin(\omega t)  \ud t 
\end{equation*}
\(\omega = 2 \pi f\)
\begin{equation*}
S(\omega) =  \int \limits_{\textcolor{green}{-\infty}}^{\textcolor{green}{\infty}} s(t) \cos (2 \pi t \textcolor{red}{f})  \ud t \, - \,  i   \int \limits_{\textcolor{green}{-\infty}}^{\textcolor{green}{\infty}}  s(t) \sin(2 \pi t \textcolor{red}{f})  \ud t 
\end{equation*}
\(P\rightarrow \infty\) \url{https://dspillustrations.com/pages/posts/misc/the-complex-fourier-series-and-its-relation-to-the-fourier-transform.html}
\end{frame}
%%%%%%%%%%%%%%%%%%%%
\note{
Let's recall the definition of Fourier coefficients. 
I have replaced \(x\) argument from the previous definition by \(t\).
Let's recall the forward Fourier transform and substitute the definition of angular frequency.
Now similarities between Fourier series coefficients and Fourier transform are obvious.
The difference is that instead of \(n/P\) we have frequency \(f\) and instead of integration interval \(P\) we have \((-\infty, \infty)\).

The Fourier transform can be viewed as the limit of the Fourier series of a function when the period approaches to infinity, so the limits of integration change from one period to \((-\infty, \infty)\).

You can find more details about it under this link. 
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Fourier series vs Fourier transform (2)}
\begin{columns}[T]
	\begin{column}{0.5\textwidth}	
		\textbf{Fourier series}
		\begin{itemize}
		\item Periodic function \(\Rightarrow\) converts into a \emph{discrete} sine and cosine function
		\item Non-periodic function \(\Rightarrow\) not applicable
		\end{itemize}
	\end{column}
	\begin{column}{0.5\textwidth}	
		\textbf{Fourier transform}
		\begin{itemize}
			\item Periodic function \(\Rightarrow\) transforms its Fourier series into the frequency domain
			\item Non-periodic function \(\Rightarrow\) transforms it into continuous frequency domain
			\end{itemize}
	\end{column}
\end{columns}
\vspace{10mm}
\begin{block}{Periodic function}
A periodic function is a function that repeats its values in regular intervals or periods.
\end{block}
\end{frame}	
%%%%%%%%%%%%%%%%%%%%
\note{These findings can be summarized as follows.
Fourier series is used to convert periodic function into discrete function as a sum of sines and cosines. 	
The word \emph{discrete} is debatable from mathematical point of view because of function jumps at discontinouities.
I would say that from a point of view of an engineer, the resulting function is continous because it is a sum of continous functions.
Fourier series cannot be applied to non-periodic functions.
 
Fourier transform is used to transform periodic and non-periodic signals from the time domain to the continuous frequency domain. 
It can also transform Fourier series into the frequency domain, as Fourier series is nothing but a simplified form of the time domain periodic function.
So, the Fourier transform is more general.
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Discrete Fourier Transform}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Discrete Fourier Transform}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
Given \(N\) values \(u_0,\cdots, u_{N-1}\), the following holds:
\end{center}
\begin{columns}[T]
	\begin{column}{0.5\textwidth}	
		\textbf{Discrete Fourier transform (DFT)}
		\begin{equation*}
		\hat{u} _k = \sum \limits_{j=0}^{N-1} u_j \myexp^{-i 2 \pi j k/N}
		\end{equation*}
	\end{column}
	\begin{column}{0.5\textwidth}	
		\textbf{Inverse discrete Fourier transform (IDFT)}
		\begin{equation*}
		u _j = \frac{1}{N}\sum \limits_{k=0}^{N-1} \hat{u}_k \myexp^{i 2 \pi j k/N}
		\end{equation*}
	\end{column}
\end{columns}
\begin{block}{Fast Fourier transform}
A fast Fourier transform (FFT) is an algorithm that computes the discrete Fourier transform (DFT) of a sequence, or its inverse (IDFT).
The algorithm manages to reduce the complexity of computing the DFT from \(O\left(N^{2}\right)\),  to \( O\left(N\log N\right)\), where \(N\) is the data size.
\end{block}
\end{frame}
%%%%%%%%%%%%%%%%%%%%
\note{So far I talk about continuous Fourier transform.
However, most often you will use discrete Fourier transform or rather its numerical implementation.
Given \(N\) values \(u_0,\cdots, u_{N-1}\), the following holds:
The first equation gives the discreter Fourier transform of the sequence \(\{u_j\}\);
the second gives the inverse discrete Fourier transform of the sequence \(\{\hat{u}_k\}\). \(u_j\) and \( \hat{u}_k \) are in general complex.
Note that although the formulae in these equations define the direct and inverse DFTs, they are almost never used to calculate them.
The reason is that they are computationally inefficient for large \(N\).
Instead, an elegant algorithm called Fast Fourier Transform (FFT in short) is used.
This is really just a clever way of re-arranging the multiplications and sums using the properties of the exponential function, to reduce the total number of arithmetic operations.
The algorithm manages to reduce the complexity of computing the DFT from \(O\left(N^{2}\right)\),  to \( O\left(N\log N\right)\), where \(N\) is the data size.
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[fragile]{Discrete Fourier Transform in MATLAB}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{columns}[T]
	\begin{column}{0.5\textwidth}	
		\textbf{Discrete Fourier transform (DFT)}
		\begin{equation*}
		U (k) = \sum \limits_{j=1}^{N} u(j) \,\myexp^{-i 2 \pi (j-1) (k-1)/N}, \quad k=1\ldots N
		\end{equation*}
		
		\begin{verbatim}
		U = fft(u)
		\end{verbatim}
	\end{column}
	\begin{column}{0.5\textwidth}	
		\textbf{Inverse discrete Fourier transform (IDFT)}
		\begin{equation*}
		u(j) = \frac{1}{N}\sum \limits_{k=1}^{N} U(k)\, \myexp^{i 2 \pi (j-1) (k-1)/N}, \quad j=1\ldots N
		\end{equation*}
		
		\begin{verbatim}
		u = ifft(U)
		\end{verbatim}
	\end{column}
\end{columns}
\end{frame}
%%%%%%%%%%%%%%%%%%%%
\note{Vectors and matrices in some programming languages (including MATLAB) start at index 1 instead of 0.
Therefore, the following formulae were implemented in MATLAB by using the FFT.
Note that lower case letter and upper case letter u are used in appropriate places.
Also indices \(j\) and \(k\) are placed in round brackets which is compliant with MATLAB notations.
fft and ifft commands are used in MATLAB for disrete Fourier transform and inverse discrete Fourier transform, respectively.
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[fragile]{Interpretation of variables}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
displacements - sequence \( u(j) = u_1, u_2, \ldots, u_{N}\)\\
corresponding spatial coordinates:
\begin{equation*}
x(j) = x_{start} +(j-1)  \Delta x, \quad j=1 \ldots N
\end{equation*}
The sequence  \( u(j) \) is a \emph{sampling} of the physical quantity in \(N\) points with \emph{sampling interval} \(\Delta x\).\\
What is the interpretation of the Fourier transform \(U(k)\)?\\
These are complex values that specify the amplitude and phase of the set of \(N\) Fourier components, that jointly exactly represent the original sequence.
The frequencies of the Fourier components are \alert{equidistant}:
\begin{equation*}
f_k = (k-1) \Delta f, \quad k = 1 \ldots N, \quad \Delta f = \frac{1}{N \Delta x}
\end{equation*}
Units \(x\) [m] \(\rightarrow\) \(f\) [1/m]\\
 \hspace{10mm}\(x\) [s] \(\rightarrow\) \(f\) [Hz]
\end{frame}
%%%%%%%%%%%%%%%%%%%%
\note{In physcal applications, the values in the sequence usually represents some measureble quantity (displacements, temperature, electrical voltage, intensity of light) in a number of equidistant points along some spatial or time coordinates.
There is then always a corresponding sequence of spatial or time coordinates.
The sequence  \( \{u_j\} \) is a \emph{sampling} of the physical quantity in \(N\) points with \emph{sampling interval} \(\Delta x\).
If we take Fourier transform of this sequence we will get complex values that specify the amplitude and phase of the set of \(N\) Fourier components, that jointly exactly represent the original sequence.
The frequencies of the Fourier components are \alert{equidistant}.
If \(x\) units are in meters, than \(f\) units are in one over meter;
If \(x\) units are in secunds, than \(f\) units are in hertz.
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Examples}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\only<1>{
	\hspace{10mm} \(u(t) = 0.5 \cos (2 \pi 10 t + \pi/6)\)
	\begin{columns}[T]
		\begin{column}{0.5\textwidth}	
			\begin{center}
			\includegraphics{FFT_example_cos_time.png}	
			\includegraphics{FFT_example_cos_real.png}
			\end{center}
		\end{column}
		\begin{column}{0.5\textwidth}
			\begin{center}
			\includegraphics{FFT_example_cos_frequency.png}	
			\includegraphics{FFT_example_cos_imag.png}
		\end{center}
		\end{column}
\end{columns}
}
\only<2>{
	\hspace{10mm} \(u(t) = 0.5 \sin (2 \pi 5 t + \pi/6)\)
	\begin{columns}[T]
		\begin{column}{0.5\textwidth}	
			\begin{center}
				\includegraphics{FFT_example_sin_time.png}	
				\includegraphics{FFT_example_sin_real.png}
			\end{center}
		\end{column}
		\begin{column}{0.5\textwidth}
			\begin{center}
				\includegraphics{FFT_example_sin_frequency.png}	
				\includegraphics{FFT_example_sin_imag.png}
			\end{center}
		\end{column}
	\end{columns}
}
\only<3>{
	\hspace{10mm} \(u(t) = 0.5 \cos (2 \pi 10 t + \pi/6) + 0.3 \sin (2 \pi 5 t + \pi/6) \)
	\begin{columns}[T]
		\begin{column}{0.5\textwidth}	
			\begin{center}
				\includegraphics{FFT_example_sin_cos_time.png}	
				\includegraphics{FFT_example_sin_cos_real.png}
			\end{center}
		\end{column}
		\begin{column}{0.5\textwidth}
			\begin{center}
				\includegraphics{FFT_example_sin_cos_frequency.png}	
				\includegraphics{FFT_example_sin_cos_imag.png}
			\end{center}
		\end{column}
	\end{columns}
}
\only<4>{
	\hspace{10mm} \(u(t) =  \left\{ \begin{array}{ll} 1& -T/2 \geq t \leq T/2 \\ 0 & \mathrm{otherwise} \end{array} \right.  ,\quad T = 10\)
	\begin{columns}[T]
		\begin{column}{0.5\textwidth}	
			\begin{center}
				\includegraphics{FFT_example_rectangular_pulse_wide_time.png}	
				\includegraphics{FFT_example_rectangular_pulse_wide_real.png}
			\end{center}
		\end{column}
		\begin{column}{0.5\textwidth}
			\begin{center}
				\includegraphics{FFT_example_rectangular_pulse_wide_frequency.png}	
				\includegraphics{FFT_example_rectangular_pulse_wide_imag.png}
			\end{center}
		\end{column}
	\end{columns}
}
\only<5>{
	\hspace{10mm} \(u(t) =  \left\{ \begin{array}{ll} 1& -T/2 \geq t \leq T/2 \\ 0 & \mathrm{otherwise} \end{array} \right.  ,\quad T = 1\)
	\begin{columns}[T]
		\begin{column}{0.5\textwidth}	
			\begin{center}
				\includegraphics{FFT_example_rectangular_pulse_narrow_time.png}	
				\includegraphics{FFT_example_rectangular_pulse_narrow_real.png}
			\end{center}
		\end{column}
		\begin{column}{0.5\textwidth}
			\begin{center}
				\includegraphics{FFT_example_rectangular_pulse_narrow_frequency.png}	
				\includegraphics{FFT_example_rectangular_pulse_narrow_imag.png}
			\end{center}
		\end{column}
	\end{columns}
}
\only<6>{
	%\vspace{-5mm}
	{\Large \(u(t) =\myexp^{\frac{-2 \log(2) (t-t0)^2}{\sigma^2}} \cos\left(2 \pi f_c (t - t_0)\right), \quad f_c = 375\, \mathrm{THz},\, \sigma =  8\, \mathrm{fs}\)}
	\begin{columns}[T]
		\begin{column}{0.5\textwidth}	
			\begin{center}
				\includegraphics{FFT_example_gauss_time.png}	
				\includegraphics{FFT_example_gauss_real.png}
			\end{center}
		\end{column}
		\begin{column}{0.5\textwidth}
			\begin{center}
				\includegraphics{FFT_example_gauss_frequency.png}	
				\includegraphics{FFT_example_gauss_imag.png}
			\end{center}
		\end{column}
	\end{columns}
}
\end{frame}
%%%%%%%%%%%%%%%%%%%%
\note{Real values of continuous Fourier transform of rectangular pulse happens to be a sinc function. 
However, discrete Fourier transform was applied here so the result only resembles sinc function.}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Aliasing (1)}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\begin{alertblock}{Aliasing}
		It is irreversible signal distortion in the sampling process resulting from failure to meet the assumptions about the sampling theorem. 
		Distortion is manifested by the presence of erroneous frequency components (aliases) in the resulting signal.
	\end{alertblock}
	Aliasing results from the ambiguous representation of the periodic signal by a series of its instantaneous values (samples) taken at equal intervals.
	
	If the continuous signal contains components up to frequency \(f_{max}\), it is necessary to choose:
	\begin{equation*}
	\Delta x < \frac{1}{2 f_{max}}
	\end{equation*}
	in order to avoid aliasing. In other words, the minimum sampling frequency is \(2 f_{max}\).\\
	For example, our hearing ability is up to about 22 kHz.
	Therefore, the sampling frequency for music recording should be at least 44 kHz.
\end{frame}
%%%%%%%%%%%%%%%%%%%%
\note{
	The DFT can be regarded as an approximation of the continuous Fourier transform, which it approaches when N goes to infinity and/or \(\Delta x\) goes to zero. 
	In practice, \(N\) and \(\Delta x\) are always finite, which causes some undesirable
	effects. 
	Two important effects of the sampling are: aliasing and finite frequency resolution.
	
	Aliasing is an effect that causes different signals to become indistinguishable (or aliases of one another) when sampled.
	It also often refers to the distortion or artifact that results when a signal reconstructed from samples is different from the original continuous signal.
	Aliasing can occur in signals sampled in time, for instance digital audio, and is referred to as temporal aliasing. 
	It can also occur in spatially sampled signals (e.g. moiré patterns in digital images); this type of aliasing is called spatial aliasing.
	In order to avoid aliasing, the sampling frequency should be at least twice the maximum frequency component of analysed signal.
	For example, our hearing ability is up to about 22 kHz.
	Therefore, the sampling frequency for music recording should be at least 44 kHz.
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Aliasing (2)}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{columns}[T]
	\begin{column}{0.5\textwidth}
			\begin{center}
			\includegraphics{Aliasing_1.png}	
		\end{center}
	\end{column}
	\begin{column}{0.5\textwidth}
		\only<1->
		{
   			\begin{flalign*}
         		& f_s = 1 \\
   		 		&\color{red}{s_1=\sin(2 \pi \,1/8 \,f_s t)}\\
   		 		&\color{logoblue}{s_2=\sin\left(2 \pi (1/8-1) f_s t\right)}
  			 \end{flalign*}
		}
		\only<2>
		{
			\begin{flalign*}
				&\color{logoblue}{s_2=\sin(2 \pi \underbrace{(1/8-1) f_s}_{f_{max}=7/8 f_s} t)} \\
				&\hat{f_s} = 2 f_{max} = 14/8 f_s = 1.75 f_s\\
				&1.75\times 9\, \mathrm{points} \approx 16\, \mathrm{points}
			\end{flalign*}
		}
	\end{column}
\end{columns}
\end{frame}
%%%%%%%%%%%%%%%%%%%%
\note{
At sampling interval denoted by black dots	these sine functions are aliases of each other.
We are not able to disgtinguish them.
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Heat transfer problem}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Signal filtering}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Image filtering}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Assignment}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
{\setbeamercolor{palette primary}{fg=black, bg=white}
\begin{frame}[standout]
  Thank you for your attention!\\ \vspace{12pt}
  Questions?\\ \vspace{12pt}
  \url{pk@imp.gda.pl}
\end{frame}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% END OF SLIDES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}